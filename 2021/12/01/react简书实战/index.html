<!DOCTYPE html>
<html lang="zh-Hans">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 4.2.1">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon32X32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon16X16.png">
  <link rel="mask-icon" href="/images/mylogo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">

<link rel="stylesheet" href="https://fonts.loli.net/css?family=Noto Serif SC:300,300italic,400,400italic,700,700italic|Roboto Slab:300,300italic,400,400italic,700,700italic|Hack:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">
<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css">
  <link rel="stylesheet" href="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"wzt2022.github.io","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":18,"onmobile":false},"copycode":{"enable":true,"show_result":true,"style":"mac"},"back2top":{"enable":true,"sidebar":false,"scrollpercent":true},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":true,"mediumzoom":false,"lazyload":true,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":true,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":true,"transition":{"post_block":"fadeIn","post_header":"slideLeftBigIn","post_body":"slideRightBigIn","coll_header":"slideLeftIn","sidebar":"slideLeftBigIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="react简书实战day1实战环节  环境的搭建-&gt;Header组件的编写-&gt;首页的编写-&gt;详情页的编写-&gt;登陆相关业务逻辑的处理-&gt;项目开发结束上线  核心技术点  creat-react-app脚手架工具进行项目的搭建  组件化思维进行项目开发  深入学习jsx模板语法  项目的开发调试  虚拟DOM和diff算法，生命周期  项目react-transition">
<meta property="og:type" content="article">
<meta property="og:title" content="React 简书实战">
<meta property="og:url" content="https://wzt2022.github.io/2021/12/01/react%E7%AE%80%E4%B9%A6%E5%AE%9E%E6%88%98/index.html">
<meta property="og:site_name" content="TT の 博客">
<meta property="og:description" content="react简书实战day1实战环节  环境的搭建-&gt;Header组件的编写-&gt;首页的编写-&gt;详情页的编写-&gt;登陆相关业务逻辑的处理-&gt;项目开发结束上线  核心技术点  creat-react-app脚手架工具进行项目的搭建  组件化思维进行项目开发  深入学习jsx模板语法  项目的开发调试  虚拟DOM和diff算法，生命周期  项目react-transition">
<meta property="og:image" content="https://wzt2022.github.io/images/loading.gif">
<meta property="og:image" content="https://wzt2022.github.io/images/loading.gif">
<meta property="og:image" content="https://wzt2022.github.io/images/loading.gif">
<meta property="og:image" content="https://wzt2022.github.io/images/loading.gif">
<meta property="og:image" content="https://wzt2022.github.io/images/loading.gif">
<meta property="og:image" content="https://wzt2022.github.io/images/loading.gif">
<meta property="og:image" content="https://wzt2022.github.io/images/loading.gif">
<meta property="og:image" content="https://wzt2022.github.io/images/loading.gif">
<meta property="og:image" content="https://wzt2022.github.io/images/loading.gif">
<meta property="og:image" content="https://wzt2022.github.io/images/loading.gif">
<meta property="og:image" content="https://wzt2022.github.io/images/loading.gif">
<meta property="og:image" content="https://wzt2022.github.io/images/loading.gif">
<meta property="og:image" content="https://wzt2022.github.io/images/loading.gif">
<meta property="og:image" content="https://wzt2022.github.io/images/loading.gif">
<meta property="og:image" content="https://wzt2022.github.io/images/loading.gif">
<meta property="og:image" content="https://wzt2022.github.io/images/loading.gif">
<meta property="og:image" content="https://wzt2022.github.io/images/loading.gif">
<meta property="og:image" content="https://wzt2022.github.io/images/loading.gif">
<meta property="og:image" content="https://wzt2022.github.io/images/loading.gif">
<meta property="og:image" content="https://wzt2022.github.io/images/loading.gif">
<meta property="og:image" content="https://wzt2022.github.io/images/loading.gif">
<meta property="article:published_time" content="2021-11-30T16:00:00.000Z">
<meta property="article:modified_time" content="2021-11-30T16:00:00.000Z">
<meta property="article:author" content="Jony J">
<meta property="article:tag" content="简书实战">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://wzt2022.github.io/images/loading.gif">

<link rel="canonical" href="https://wzt2022.github.io/2021/12/01/react%E7%AE%80%E4%B9%A6%E5%AE%9E%E6%88%98/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-Hans'
  };
</script>

  <title>React 简书实战 | TT の 博客</title>
  


  <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?6f41e725d94bfbcea62c56e046b8a37a";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>




  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

<link rel="alternate" href="/atom.xml" title="TT の 博客" type="application/atom+xml">
</head>
<!-- 页面点击小红心 -->
 <script async src="/js/fireworks.js"></script>
<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">TT の 博客</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">远方除了遥远，一无所有。</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a>

  </li>
        <li class="menu-item menu-item-life">

    <a href="/life/" rel="section"><i class="fa fa-heart fa-fw"></i>生活中的美好</a>

  </li>
        <li class="menu-item menu-item-photo">

    <a href="/photo/" rel="section"><i class="fa fa-image fa-fw"></i>照片</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>

  <a href="https://github.com/lf2021" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="https://wzt2022.github.io/2021/12/01/react%E7%AE%80%E4%B9%A6%E5%AE%9E%E6%88%98/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="Jony J">
      <meta itemprop="description" content="stay hungry stay foolish！">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="TT の 博客">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          React 简书实战
        </h1>

        <div class="post-meta">
          
              <i class="fa fa-thumb-tack"></i>
              <font color=7D26CD>置顶</font>
              <span class="post-meta-divider">|</span>
          
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-12-01 00:00:00" itemprop="dateCreated datePublished" datetime="2021-12-01T00:00:00+08:00">2021-12-01</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/React/" itemprop="url" rel="index"><span itemprop="name">React</span></a>
                </span>
            </span>

          
            <span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv" style="display: none;">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span id="busuanzi_value_page_pv"></span>
            </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2021/12/01/react%E7%AE%80%E4%B9%A6%E5%AE%9E%E6%88%98/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2021/12/01/react%E7%AE%80%E4%B9%A6%E5%AE%9E%E6%88%98/" itemprop="commentCount"></span>
    </a>
  </span>
  
  <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>40k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>37 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h1 id="react简书实战"><a href="#react简书实战" class="headerlink" title="react简书实战"></a>react简书实战</h1><h2 id="day1"><a href="#day1" class="headerlink" title="day1"></a>day1</h2><p><strong>实战环节</strong></p>
<blockquote>
<p>环境的搭建-&gt;Header组件的编写-&gt;首页的编写-&gt;详情页的编写-&gt;登陆相关业务逻辑的处理-&gt;项目开发结束上线</p>
</blockquote>
<p><strong>核心技术点</strong></p>
<ol>
<li><p>creat-react-app脚手架工具进行项目的搭建</p>
</li>
<li><p>组件化思维进行项目开发</p>
</li>
<li><p>深入学习jsx模板语法</p>
</li>
<li><p>项目的开发调试</p>
</li>
<li><p>虚拟DOM和diff算法，生命周期</p>
</li>
<li><p>项目react-transition-group第三方的模块实现复杂的动画效果</p>
</li>
<li><p>Redux  Antd UI组件 容器组件 无状态组件等等内容</p>
</li>
<li><p>redux使用之中的redux中间键 比如redux-thunk、redux-saga这些新的技术</p>
</li>
<li><p>项目样式布局采用最新的Styled-components技术来实现CSS样式的编码，避免组件之间样式的互相影响</p>
</li>
<li><p>在进行redux之中数据管理的时候，使用react推出的数据框架 Immutable.js，这个库有效的避免我们对数据的误操作</p>
<p>如果使用这个库还会涉及redux-immutable这个redux的中间键</p>
</li>
<li><p>使用axios这个工具发送ajax请求</p>
</li>
</ol>
<p><strong>react基础知识的巩固</strong></p>
<blockquote>
<p>React开发环境的准备：引入.js文件来使用React-&gt;通过脚手架工具来编码-&gt;Create-react-app官网提供的脚手架</p>
</blockquote>
<ul>
<li><p>创建脚手架： </p>
<ol>
<li><p>检查node -v的版本 和 npm -v的版本 </p>
</li>
<li><p>输入命令<code>npm install -g create-react-app</code></p>
</li>
<li><p>输入命令<code>create-react-app 文件夹名</code>   </p>
</li>
<li><p>创建之后切换到创建的文件夹 <code>cd 文件名夹</code></p>
</li>
<li><p>运行yarn start即可显示 React 主界面 </p>
</li>
</ol>
</li>
<li><p>三个文件：</p>
<p>   （1）public下的index.html文件 ：页面上显示的html的内容</p>
<p>​      （2）src下的index.js： 整个react项目的入口文件 会引入App文件</p>
<p>​      （3）src下的App.js ： 负责页面上显示Hello Word的内容</p>
</li>
</ul>
<h2 id="day2"><a href="#day2" class="headerlink" title="day2"></a>day2</h2><blockquote>
<p>React中的组件</p>
</blockquote>
<p>​    定义组件：定义的那个类继承<code>React.Component</code></p>
<ul>
<li><p>只要是jsx语法想在react之中正常的运行，就要引入react   例如 组件<APP/>（组件标签都需要大写开头）  render()下的<div> （小写开头的就是h5标签）这些都属于jsx语法</p>
</li>
<li><p><code>index.js ``文件中通过ReactDOM将APP这个组件显示在``id=root</code>这个标签下面</p>
</li>
<li><p><code>render</code>返回的必须是在一个大的元素之中，但是有时候又不想让这个div显示就可以用<Fragmrnt></Fragmrnt>的占位符来替代最外层的div，不会渲染为任何标签</p>
</li>
</ul>
<figure class="highlight aspectj"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&lt;input </span><br><span class="line">	value=&#123;<span class="keyword">this</span>.state.inputvalue&#125; --inputvalue就是输入框的值</span><br><span class="line">	onChange=&#123;<span class="keyword">this</span>.handleInputChange&#125; --通过调用该函数来改变改值</span><br><span class="line">/&gt;</span><br><span class="line"></span><br><span class="line">handleInputChange=(e)=&gt;&#123;</span><br><span class="line">   <span class="keyword">this</span>.state.inputValue = e.<span class="keyword">target</span>.vaue</span><br><span class="line">   console.log(e.<span class="keyword">target</span>.value)  --e.<span class="keyword">target</span>是Input框返回的DOM节点，e.<span class="keyword">target</span>.value返回的就是value值</span><br><span class="line">   console.log(<span class="keyword">this</span>)</span><br><span class="line">   <span class="keyword">this</span>.setState(&#123;</span><br><span class="line">   		inputValue:e.<span class="keyword">target</span>.value</span><br><span class="line">   &#125;)</span><br><span class="line">&#125;</span><br><span class="line">/*如果需要实现改变inputvalue的值就在handleInputChange函数里写<span class="keyword">this</span>.state.inputValue = e.<span class="keyword">target</span>.vaue</span><br><span class="line">如果handleInputChange这个函数没有使用箭头函数,此时的<span class="keyword">this</span>为undefined，可以使用ES6的语法将<span class="keyword">this</span>的指向指向为Todolist组件</span><br><span class="line">onChange=&#123;<span class="keyword">this</span>.handleInputChange.bind(<span class="keyword">this</span>)&#125;即可。</span><br></pre></td></tr></table></figure>
<ul>
<li><p>改变state里的数据不能像上述引用的方式去改变，必须调用setState的方法去改变state里的数据。</p>
</li>
<li><p>由于react中state是不允许做任何的改变的immutable的特性，因此我们在做list操作的时候需要先做一个拷贝，对拷贝的数据进行处理 如果改变之后做性能优化的时候就会出现问题。</p>
</li>
</ul>
<blockquote>
<p>JSX细节语法补充</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span>两种注释方法:</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">//注释内容 </span></span><br><span class="line">    &#125;</span><br><span class="line">    或者</span><br><span class="line">    &#123;<span class="comment">/*注释内容*/</span>&#125;</span><br><span class="line"><span class="number">2.</span>为了防止某些标签的内容不被转义  也就是在输入框输入&lt;h1&gt;啦啦啦&lt;h1/&gt;点击提交的时候是显示啦啦啦</span><br><span class="line"> <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">li</span> <span class="attr">key</span>=<span class="string">&#123;index&#125;</span> <span class="attr">onClick</span>=<span class="string">&#123;this.handledelete&#125;</span> <span class="attr">dangerouslySetInnerHTML</span>=<span class="string">&#123;&#123;__html:item&#125;&#125;</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="number">3.</span>在输入框前添加label标签的时候 点击babel标签的内容光标会自动聚焦到输入框上</span><br><span class="line">    &lt;label htmlFor=<span class="string">'insertArea'</span>&gt;输入内容&lt;<span class="regexp">/label&gt;</span></span><br><span class="line"><span class="regexp">	&lt;input id='insertArea' className='input' value=&#123;inputvalue&#125;</span></span><br></pre></td></tr></table></figure>
<p><strong>注意</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">新版的react  setState返回的不是一个对象了 要把对象替换成函数</span><br><span class="line">之前: handlechange=<span class="function">(<span class="params">e</span>)=&gt;</span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.setState(</span><br><span class="line">      &#123;<span class="attr">inputvalue</span>:e.target.value&#125;</span><br><span class="line">    )&#125; </span><br><span class="line"></span><br><span class="line">现在:  <span class="keyword">const</span> value = e.target.value  <span class="comment">//对value值做保存 </span></span><br><span class="line">	  <span class="keyword">this</span>.setState(<span class="function"><span class="params">()</span>=&gt;</span>(&#123;</span><br><span class="line">          inputvalue:value&#125;)) <span class="comment">//写成函数就会变成异步的setState 如果直接写e.target.value就会有问题</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>React优点</strong></p>
<ol>
<li>声明式开发：使得我们能减少大量DOM操作代码量</li>
<li>可以与其他框架并存</li>
<li>组件化</li>
<li>单向数据流</li>
<li>视图层框架</li>
<li>函数式编程  好处：用react写出来的项目更容易实现前端自动化测试</li>
</ol>
<p><strong>思考</strong></p>
<blockquote>
<p>单向数据流：父组件可以向子组件传值，但是子组件不能改变这个值，只能单向进行传递，不能反过来修改。这就说明为什么在修改item项目的时候，为什么不向子组件传递一个list，而要传递index与item了。</p>
<p>再或者说如果一个父组件有很多个子组件且子组件都共用list，如果将list传给某一个子组件且在该子组件进行修改，会导致其余四个组件中list也发生变化，这样页面出现bug的时候，就不知如何去定位这个bug，对代码的调试是很不方便的，因此要有单向数据流的概念。</p>
<p>如果真的想修改：首先父组件传递给子组件一个方法，在子组件去调用父组件传的这个方法，然后去做删除。</p>
<p>React是一个视图层的框架:react并不是什么问题都解决，只帮助你解决数据和页面渲染上的一些东西，至于组件之间怎么传值（就如1给2传递的话就不能按一层一层传了），并不负责，交给其他组件来做，做到大型项目时，react不够用，只能借助它去搭建视图，做组件传值的时候还要借助redux等的数据层的框架来做额外的支撑。</p>
</blockquote>
<p><img data-src="/images/loading.gif" data-original="https://gitee.com/letter-from-berlin/PictureBed/raw/master/202111171547264.png" alt="image-20211117154738062"></p>
<p><strong>巩固知识</strong></p>
<ul>
<li>父组件给子组件传值的时候，子组件要对传来的值做类型的限制。如果对传来的值做了isRequired的限制，如果不传就会报错。</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">限制类型有两种放置方法:</span><br><span class="line">    <span class="number">1.</span>TodoItem.propTypes=&#123;</span><br><span class="line">           item:PropTypes.string,</span><br><span class="line">           dele:PropTypes.func,</span><br><span class="line">           index:PropTypes.number</span><br><span class="line">       &#125; --放置在定义完组件的下方（最下方）</span><br><span class="line">    <span class="number">2.</span>TodoItem.propTypes=&#123;</span><br><span class="line">           item:PropTypes.string,</span><br><span class="line">           dele:PropTypes.func,</span><br><span class="line">           index:PropTypes.number</span><br><span class="line">       &#125; --放置在render的上方</span><br></pre></td></tr></table></figure>
<ul>
<li><p>当组件的state和props发生改变的时候，render函数就会重新执行。</p>
</li>
<li><p>当父组件的render函数被运行时，它的子组件的render都将重新运行一次。</p>
</li>
</ul>
<p><strong>虚拟DOM</strong>(本质上就是一个js对象，之所以能提高性能，因为js去比较js对象不怎么耗性能，去比较真实的DOM很耗性能)</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">真实DOM和虚拟DOM性能的差异:</span><br><span class="line">    使用真实DOM</span><br><span class="line">    <span class="number">1.</span> state数据 **初始数据state</span><br><span class="line">    <span class="number">2.</span> JSX 模版  **对应render里的jsx代码</span><br><span class="line">    <span class="number">3</span>．数据+模版结合，生成真实的DOM，来显示</span><br><span class="line">    <span class="number">4.</span> state 发生改变</span><br><span class="line">    <span class="number">5</span>．数据＋模版结合，生成真实的DOM，并不直接替换原始的DOM</span><br><span class="line">    <span class="number">6</span>．新的DOM 和原始的DOM做比对，找差异</span><br><span class="line">    <span class="number">7.</span>找出input框发生了变化</span><br><span class="line">    <span class="number">8.</span>只用新的DOM中的input元素，替换掉老的DOM中的input元素  </span><br><span class="line">        **相比全部替换原始DOM性能提升 </span><br><span class="line">		**但是还是消耗了一部分性能:新的DOM和原始DOM做比对的性能 性能提升也不是很明显</span><br><span class="line"></span><br><span class="line">    使用虚拟DOM:</span><br><span class="line">    <span class="number">1.</span> state数据</span><br><span class="line">    <span class="number">2.</span> JSX 模版</span><br><span class="line">    <span class="number">3.</span> 数据+模版结合,生成真实的DOM，来显示</span><br><span class="line">    假设真实DOM为:<span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">'abc'</span>&gt;</span><span class="tag">&lt;<span class="name">span</span>&gt;</span>hello world<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    <span class="number">4</span>．生成虚拟DOM(虚拟DOM就是一个JS对象，用它来描述真实DOM)(相比上面第四步没有生成虚拟DOM 实看是损耗了性能)</span><br><span class="line">    [ <span class="string">'div'</span>, &#123;<span class="attr">id</span>: <span class="string">'abc'</span>&#125;, [ <span class="string">'span'</span>,&#123;&#125;,<span class="string">'hello world '</span>]]  <span class="comment">//标签名 标签属性  标签内容  **JS对象 也就是虚拟DOM</span></span><br><span class="line">    <span class="number">5.</span> state 发生变化</span><br><span class="line">    <span class="number">6.</span> 数据+模版生成新的虚拟DOM(极大的提升了性能相比创建真实DOM，js对象创建的过程性能是极低的)</span><br><span class="line">    [ <span class="string">'div'</span>, &#123;<span class="attr">id</span>: <span class="string">'abc'</span>&#125;,[ <span class="string">'span'</span>, &#123;&#125;,<span class="string">'bye bye'</span> ]]</span><br><span class="line">    <span class="number">7</span>．比较原始虚拟DOM和新的虚拟DOM的区别,找到区别是span中内容(极大的提升性能)</span><br><span class="line">        **比对的是原始的js对象和新的js对象两个js对象的比较是极不损耗性能的。</span><br><span class="line">    <span class="number">8</span>．直接操作DOM，改变span中的内容</span><br></pre></td></tr></table></figure>
<p><strong>深入了解虚拟DOM</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">实际的流程是:</span><br><span class="line">    <span class="number">1.</span> state数据</span><br><span class="line">    </span><br><span class="line">    <span class="number">2.</span> JSX 模版（类似于div）</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/*JSX -&gt; createElement方法 -&gt; JS对象 -&gt; 真实的DOM</span></span><br><span class="line"><span class="comment">      return &lt;div&gt;item&lt;div&gt; =&gt;等价为</span></span><br><span class="line"><span class="comment">      return React.createElement('div',&#123;&#125;,'item')</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    </span><br><span class="line">    <span class="number">3</span>．数据 + 模板 生成虚拟DOM(虚拟DOM就是一个JS对象，用它来描述真实DOM)(损耗了性能)</span><br><span class="line">    [ <span class="string">'div'</span>, &#123;<span class="attr">id</span>: <span class="string">'abc'</span>&#125;, [ <span class="string">'span'</span>,&#123;&#125;,<span class="string">'hello world '</span>]]</span><br><span class="line"></span><br><span class="line">    <span class="number">4.</span> 用虚拟DOM的结构生成真实的DOM，来显示</span><br><span class="line">    &lt;div id=<span class="string">'abc'</span>&gt;<span class="xml"><span class="tag">&lt;<span class="name">span</span>&gt;</span>hello world<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span>&lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">    5. state 发生变化</span></span><br><span class="line"><span class="regexp">    </span></span><br><span class="line"><span class="regexp">    6. 数据+模版生成新的虚拟DOM(极大的提升了性能)</span></span><br><span class="line"><span class="regexp">    [ 'div', &#123;id: 'abc'&#125;,[ 'span', &#123;&#125;,'bye bye' ]]</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">    7．比较原始虚拟DOM和新的虚拟DOM的区别,找到区别是span中内容(极大的提升性能)</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">    8．直接操作DOM，改变span中的内容</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">虚拟DOM的好处: 1.性能提升:因为生成真实DOM要耗费很大的性能</span></span><br><span class="line"><span class="regexp">			 2.它使得跨端应用得以实现</span></span><br><span class="line"><span class="regexp">             </span></span><br><span class="line"><span class="regexp">第2点好处的底层原理:没有虚拟DOM React是无法写原生应用的，根本无法在原生（React Native）的应用里被使用。</span></span><br><span class="line"><span class="regexp">例如:没有虚拟DOM，流程就是准备好state数据和模板之后就会渲染DOM，渲染DOM在浏览器是没有问题的，可是在移动端的原生应用里，比如安卓或者ios机器上的代码是不存在DOM这个概念的，所以没有虚拟DOM，在原生的应用里根本无法被使用，所以代码只能运行在浏览器里面，但是有虚拟DOM就不一样了，代码首先会被转化为虚拟DOM（是个js对象）js对象在浏览器可以被识别，在原生的应用里也可以被识别。</span></span><br><span class="line"><span class="regexp">换句话说:虚拟DOM生成好了在浏览器下面，可以将虚拟DOM变成真实DOM，浏览器下面会显示出真实的页面。假设在原生应用里，虚拟DOM生成之后可以不生成真实DOM，而让虚拟DOM生成些原生的组件，这样的话同样的代码包括state，jsx的代码都可以被复用，原生的应用里面可以把对应的页面展示出来。因为生成的虚拟DOM，在哪里都可以运行，只需要在网页上将虚拟DOM转化为真实DOM，这样的话网页就可以跑起来。这使得React既能开发网页应用，还可以开发原生应用</span></span><br></pre></td></tr></table></figure>
<p><strong>虚拟DOM中的Diff算法</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">比较原始虚拟DOM和新的虚拟DOM的区别,找到区别是span中内容(极大的提升性能)</span><br><span class="line">当数据发生改变的时候（state和props的改变，其实props的改变实际上也是父组件的state发生改变），虚拟DOM和真实DOM才会发生比对。</span><br><span class="line">归根到底，当你调用setState的时候，数据才发生改变，然后虚拟DOM才发生比对。（setState是异步的，实际上是为了提升react底层的性能，原因:假设连续调用三次setState，变更三组数据，React会把三次setState合并成一次，只是做了一次虚拟DOM的比对，然后去更新一次DOM，可以额外减去那两次DOM比对带来的性能上的耗费）--性能优化</span><br><span class="line">Diff算法就是两个虚拟DOM比对的算法，React采用的是同层的虚拟DOM比对的算法。左边的为虚拟DOM，当数据改变的时候会生成新的虚拟DOM。同层比对，如果一层不满足要求，之后的也不比对了，后面的就直接废弃掉，整个就替换掉，这样会提升性能。（直观上如果第一层不一样后面都一样，导致后面一样的节点没办法复用，性能很低，怎么会提升性能。实际上是因为同层比对的算法很简单，算法简单带来的是比对的速度会非常快。虽然可能会导致DOM重新渲染上的浪费，但是它大大的减少了两个虚拟DOM之间比对的算法上性能的消耗。） </span><br><span class="line">key值要保持相对稳定，在项目中能不用index做key值就不用。</span><br><span class="line">同层比对和key值比对这些比对的方式都是Diff算法的一部分。--性能优化</span><br></pre></td></tr></table></figure>
<p><img data-src="/images/loading.gif" data-original="https://gitee.com/letter-from-berlin/PictureBed/raw/master/202111302200890.png" alt="image-20211130220031980"></p>
<p><strong>ref</strong></p>
<blockquote>
<p>如果ref和setState一起使用的时候，要注意setState是异步函数，不会立马执行。有时候会使得无法正确输出页面DOM的真实情况</p>
<p>为了避免这种情况，setState还有第二个参数，它是一个回调函数，执行的时机是在等异步的完全结束了再执行。</p>
</blockquote>
<p><strong>生命周期函数</strong></p>
<blockquote>
<p>生命周期函数指在某一个时刻组件会自动调用的函数（当state和pros变化的时候render就会被调用，render函数就是生命周期函数）  组件一创建就会被调用 constructor函数和生命周期函数</p>
<p>每一个组件都可以有生命周期函数</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">shouldComponentUpdate(nextProps,nextState) &#123;</span><br><span class="line">	<span class="keyword">if</span>(nextProps.content !==<span class="keyword">this</span>.props.content) &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">	&#125;<span class="keyword">else</span> &#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">设置shouldComponentUpdate这个声明周期函数提升了组件的性能，性能提升在避免组件做无谓的render操作。render重新执行就意味着react底层需要对组件重新生成一份虚拟DOM，这样就要和之前的虚拟DOM做比对，虽然虚拟DOM的比对比真实DOM的比对性能要快的多，但是能省略这个比对过程，当然可以节约更多的性能。--性能优化</span><br><span class="line"></span><br><span class="line"> 一般把ajax请求放到ComponentDidMount（）来做</span><br><span class="line"></span><br><span class="line"> 如何发送ajax请求，首先我们要借助一个库  在todolist输入命令行：yarn add axios   </span><br><span class="line"></span><br><span class="line"> componentDidMount() &#123;</span><br><span class="line"> 	axios.get(<span class="string">'/api/todolist'</span>)</span><br><span class="line"></span><br><span class="line">    .then(<span class="function"><span class="params">()</span>=&gt;</span>&#123;alert( <span class="string">'success'</span> )&#125;)</span><br><span class="line"></span><br><span class="line">	.catch(<span class="function"><span class="params">()</span>=&gt;</span>&#123;alert( <span class="string">'error'</span> )&#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="day3"><a href="#day3" class="headerlink" title="day3"></a>day3</h2><p><strong>CSS过渡动画</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">可以使用关键帧</span><br><span class="line">@keyframes identifier &#123;  </span><br><span class="line">    <span class="number">0</span>% &#123;</span><br><span class="line">        opacity: <span class="number">1</span>;</span><br><span class="line">        color: red;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="number">50</span>% &#123;</span><br><span class="line">        opacity: <span class="number">0.5</span>;</span><br><span class="line">        color: salmon;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="number">100</span>%&#123;</span><br><span class="line">        opacity: <span class="number">0</span>;</span><br><span class="line">        color: blue;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">.hide&#123;</span><br><span class="line">   animation: identifier <span class="number">2</span>s ease-<span class="keyword">in</span> forwards; <span class="comment">//如果没有forwards 动画执行结束</span></span><br><span class="line">&#125;</span><br><span class="line">注意:关键帧当动画执行结束后，最后一帧动画的CSS效果不会被保存下来。加了forwards属性就可以保存下来了</span><br><span class="line">实际上用CSS3开发出的动画具有局限性，涉及js动画的时候就没法处理了。因此得使用下方的模块</span><br></pre></td></tr></table></figure>
<p><strong>使用react-transition-group实现动画</strong></p>
<blockquote>
<p>使用这个可能实现更加复杂的动画效果</p>
<p>[官网文档API网址]（<a href="https://reactcommunity.org/react-transition-group/" target="_blank" rel="noopener">React Transition Group (reactcommunity.org)</a>）</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">App.js文件里</span><br><span class="line">对单个元素实现效果:</span><br><span class="line">&lt;CSSTransition&gt;组件 </span><br><span class="line"></span><br><span class="line">	&lt;CSSTransition</span><br><span class="line">            <span class="keyword">in</span>=&#123;<span class="keyword">this</span>.state.show&#125; <span class="comment">//显示的属性</span></span><br><span class="line">            timeout=&#123;<span class="number">1000</span>&#125;       <span class="comment">//显示的时间</span></span><br><span class="line">            classNames=<span class="string">'fade'</span>    <span class="comment">//入场和出场动画属性名匹配</span></span><br><span class="line">            unmountOnExit</span><br><span class="line">            onEntered=&#123;(el)=&gt;&#123;el.style.color=<span class="string">'blue'</span>&#125;&#125;<span class="comment">//入场动画结束时显示的</span></span><br><span class="line">            appear=&#123;<span class="literal">true</span>&#125;<span class="comment">//在入场动画开始前就显示样式  同时在style.css要加上appear属性           </span></span><br><span class="line">     &gt;</span><br><span class="line">            &lt;div&gt;hello&lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">	&lt;/</span>CSSTransition&gt; </span><br><span class="line">style.css文件里</span><br><span class="line">.fade-enter, .fade-appear &#123;</span><br><span class="line">    opacity: <span class="number">0</span>;</span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line">.fade-enter-active , .fade-appear-active&#123;</span><br><span class="line">    opacity: <span class="number">1</span>;</span><br><span class="line">    transition: opaciy <span class="number">1</span>s ease-<span class="keyword">in</span> ;</span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line">.fade-enter-done &#123;</span><br><span class="line">    opacity: <span class="number">1</span>;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line">补充:很多相关的API都可以展示效果（例如出场动画第一帧，中间帧等等）</span><br><span class="line"></span><br><span class="line">对多个元素实现效果: </span><br><span class="line">        &lt;TransitionGroup&gt;</span><br><span class="line">            &#123;<span class="keyword">this</span>.state.list.map(<span class="function">(<span class="params">item,index</span>)=&gt;</span>&#123;</span><br><span class="line">              <span class="keyword">return</span>( <span class="xml"><span class="tag">&lt;<span class="name">CSSTransition</span></span></span></span><br><span class="line"><span class="xml">                    timeout=&#123;1000&#125; </span></span><br><span class="line"><span class="xml">                    classNames='fade'  </span></span><br><span class="line"><span class="xml">                    unmountOnExit</span></span><br><span class="line"><span class="xml">                    onEntered=&#123;(el)=&gt;&#123;el.style.color='blue'&#125;&#125;</span></span><br><span class="line"><span class="xml">                    appear=&#123;true&#125;</span></span><br><span class="line"><span class="xml">                    key=&#123;index&#125;             </span></span><br><span class="line"><span class="xml">        				&gt;</span></span><br><span class="line"><span class="xml">            		<span class="tag">&lt;<span class="name">div</span>&gt;</span>&#123;item&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">       				 <span class="tag">&lt;/<span class="name">CSSTransition</span>&gt;</span></span>)</span><br><span class="line"></span><br><span class="line">        			&#125;)&#125;</span><br><span class="line">        &lt;<span class="regexp">/TransitionGroup&gt;</span></span><br></pre></td></tr></table></figure>
<p><strong>注意</strong>：如果<code>CSSTransition</code>实现不了的效果就可以去浏览<code>Transition</code>API。(API位置在官网文档最下方)</p>
<p><strong>redux</strong>（数据层框架）</p>
<blockquote>
<p>用一张图很好的表示有无Redux之间的区别（数据的传递更加简化，便捷）</p>
<p>有Redux不管组件的层次结构有多深，走的流程都是一样的。组件改变-&gt;数据修改-&gt;其余组件取用</p>
</blockquote>
<p><img data-src="/images/loading.gif" data-original="https://gitee.com/letter-from-berlin/PictureBed/raw/master/202111181216252.png" alt="img"></p>
<blockquote>
<p>整体redux流程：react要去改变store里的数据，首先要一个派发action，action会通过dispatch方法传递给store，store再把之前的数据state和action转发给reducers，reducers是一个函数，当reducers接收到state和action之后，做一些处理之后，会返回一个新的state给到store，store用这个新的state替换掉之前store里的数据，store数据发生改变之后，react组件会感知到store发生改变（用的是<code>store.subcribe()</code>来监测store里状态的改变）这个时候就会从store里面重新取出数据更新组件的内容，页面就发生变化了（<code>this.setState(store.getState())</code>）。 </p>
</blockquote>
<p><strong>对于todolist的案例要使点击某项实现删除某项的功能 首先先绑定一个删除的回调函数，派发一个action（某项的索引index会传进去）之后在reducers值删除（由于reduces可以接收state，但是决不能修改state）这里就要对之前的状态做一个深拷贝</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(action.type === <span class="string">'delete_todo_item'</span>)&#123;</span><br><span class="line">    <span class="keyword">const</span> newstate = <span class="built_in">JSON</span>，parse(<span class="built_in">JSON</span>.stringfy(state));</span><br><span class="line">    newState.list.splice(action.index,<span class="number">1</span>)<span class="comment">//做删除</span></span><br><span class="line">    <span class="keyword">return</span> newstate</span><br><span class="line">&#125;</span><br><span class="line">**注意** 讲解简书这个项目的老师和尚硅谷的老师（好像不需要深拷贝，用的另外一个方法）对redux基础知识的讲解有点出处。</span><br><span class="line">之后会做整合的博客</span><br></pre></td></tr></table></figure>
<p><strong>对ActionTypes的拆分：目的是为了拼写错误难以找出错误，有了拆分的文件就拼写错误控制台就会直接定位报错的位置</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> CHANGE_INPUT_VALUE=<span class="string">'change_input_value'</span></span><br></pre></td></tr></table></figure>
<p><strong>利用actionCreators对action进行管理：目的提高代码的可维护性，加上前端有自动化测试的工具，如果你把action写在一个文 件里，自动化测试也会非常方便。</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">管理前:handleInputChange(e)&#123;</span><br><span class="line"><span class="keyword">const</span> action = &#123;</span><br><span class="line">    type:CHANGE_INPUT_VALUE,</span><br><span class="line">    value:e.target.value</span><br><span class="line">&#125;;</span><br><span class="line">store.dispatch(action);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">管理后:在actionCreators文件内:</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> getInputChangeAction=<span class="function">(<span class="params">value</span>)=&gt;</span>(&#123;</span><br><span class="line">    type:CHANGE_INPUT_VALUE,</span><br><span class="line">    valuee.target.value</span><br><span class="line">&#125;)</span><br><span class="line">handleInputChange(e)&#123;</span><br><span class="line"><span class="keyword">const</span> action = getInputChangeAction(e.target.value)</span><br><span class="line">store.dispatch(action);</span><br><span class="line">&#125;</span><br><span class="line">**高代码的可维护性</span><br><span class="line">*自动化测试也会非常方便</span><br></pre></td></tr></table></figure>
<p><strong>补充</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span> store是唯一的。</span><br><span class="line"><span class="number">2.</span> 只有store能改变自己的内容。</span><br><span class="line"><span class="number">3.</span> Reducer必须是纯函数：给定固定的输入，就一定会有固定的输出，而且不会有副作用。</span><br><span class="line"><span class="number">4</span>。rudux核心API </span><br><span class="line">	-creatStore  帮助创建一个store</span><br><span class="line">	-store.dispatch 帮助派发action，action会传递给store</span><br><span class="line">	-store.getState 帮助获取store里的数据内容</span><br><span class="line">	-store.subscribe 帮助订阅store里的改变，只要store改变，store.subscribe接收的这个函数里的回调函数就会执行</span><br></pre></td></tr></table></figure>
<p><strong>UI组件和容器组件</strong></p>
<blockquote>
<p>UI组件负责页面的渲染，容器组件负责页面的逻辑</p>
</blockquote>
<p><strong>无状态组件</strong></p>
<blockquote>
<p>当一个组件只有render函数的时候，就可以使用无状态组件去替换这个普通组件</p>
<p>无状态组件相对于普通组件的优势在于：性能比较高，因为无状态组件仅仅是一个函数，普通组件是js的一个类，类生成的对象还有生命周期函数render，执行的东西要远比无状态组件要多得多。</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">无状态组件:</span><br><span class="line"><span class="keyword">const</span> 组件名 = （props）=&gt;&#123;</span><br><span class="line">    <span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line">普通组件</span><br><span class="line"><span class="class"><span class="keyword">class</span> 组件名 <span class="keyword">extends</span> <span class="title">Component</span></span>&#123;</span><br><span class="line">    render()&#123;</span><br><span class="line">        <span class="keyword">return</span> </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">前提:一个组件只有一个render的时候就可以用无状态组件去替换普通组件</span><br></pre></td></tr></table></figure>
<p><strong>Redux中发送异步请求获取数据  </strong></p>
<blockquote>
<p>通过axios发送请求，将后台返回的数据传给store，但是传之前要做几个流程。首先，创建一个actionCreartors的一个函数initListAction，然后在actionTypes（防止拼写错误的文件）定义一个常量</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">axios.get(<span class="string">'./list.json'</span>).then(<span class="function">(<span class="params">res</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="keyword">const</span> data = res.data;</span><br><span class="line">    <span class="keyword">const</span> action = initListAction(data)</span><br><span class="line">    store.dispatch(action)</span><br><span class="line">&#125;)</span><br><span class="line">然后在reducers文件里写</span><br><span class="line"><span class="keyword">if</span>(action.type === INIT_LIST_ACTION)&#123;</span><br><span class="line">    <span class="keyword">const</span> newstate = <span class="built_in">JSON</span>，parse(<span class="built_in">JSON</span>.stringfy(state));</span><br><span class="line">    newState.list = action.data;<span class="comment">//这里的data就是后台传过来的数据</span></span><br><span class="line">    <span class="keyword">return</span> newstate</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>使用Redux-thunk中间件进行ajax请求发送</strong></p>
<blockquote>
<p>这个中间件可以使我们把异步请求或者复杂的逻辑放到action里处理</p>
<p>使用redux-thunk可使得创建actionCreartors定义的函数返回的结果可以是一个函数（之前返回的是一个对象），这样就可以发异步请求。 </p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">componentDidMount()&#123;</span><br><span class="line">    <span class="keyword">const</span> action = getTodoList();</span><br><span class="line">    store.dispatch(action)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> getTodoList = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="function">(<span class="params">dispatch</span>) =&gt;</span>&#123;</span><br><span class="line">	axios.get( <span class="string">'/list.json'</span>).then(<span class="function">(<span class="params">res</span>)=&gt;</span>&#123;</span><br><span class="line">	  <span class="keyword">const</span> data = res.data;</span><br><span class="line">	  <span class="keyword">const</span> action = initListAction(data);</span><br><span class="line">      dispatch(action);  ***最终执行的</span><br><span class="line">&#125;)</span><br><span class="line">解释:componentDidMount当组件挂载时执行，store派发函数的action实则是派发给store，但是它先会默认自动执行getTodoList()这个函数，随之就会去执行那个异步action，最终派发的也就是dispatch(action)</span><br></pre></td></tr></table></figure>
<h2 id="day4"><a href="#day4" class="headerlink" title="day4"></a>day4</h2><p><strong>redux的标准流程</strong></p>
<blockquote>
<p>view在redux之中会派发一个action，action通过store的dispatch方法，分发给store，store接收到action连同之前的state一起传给reducer，reducer返回一个新的数据给store，store拿到新的状态去更新旧的状态。</p>
</blockquote>
<p> <strong>redux的中间件（redux-saga中间件的使用）</strong></p>
<blockquote>
<p>中间件的概念是指action和store之间的中间，指的是redux的中间键（dispatch的升级）因为只有redux有action和store的概念。</p>
<p>redux-sage远比redux-thunk复杂的多，里面内置了很多API</p>
<p>有一点区别的是如果上方<code>store.dispatch(action)</code>store传递的action是一个函数，store接收到action之后它不仅可以派发到reducer还可以派发到一个sagas.js的文件里，可以在sagas.js文件里做一些异步逻辑的操作。 </p>
</blockquote>
<p><strong>React-Redux的使用</strong></p>
<ol>
<li><p>给组件包裹一个<Provider store={store}></Provider>即可让组件使用store里的数据，是react-redux的核心组件。</p>
</li>
<li><p>通过redux的connect方法，将组件和store做一个连接 <code>export default connect(mapStateToProps,null)(组件)</code></p>
</li>
<li><p>做连接就有一个规则，规则就在第一个参数<code>mapStateToProps</code>（翻译过来就是把store里的数据映射给组件，变成组件的props）</p>
</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> mapStateToProps = <span class="function">(<span class="params">state</span>) =&gt;</span> &#123; <span class="comment">//state就是store里的数据</span></span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        inputvalue:state.inputvalue<span class="comment">//  这一步映射到组件的props &lt;input value=&#123;this.props.inputValue&#125;/&gt;</span></span><br><span class="line">        list:state.list </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ol>
<li>connect的第二个参数是<code>mapDispatchToProps</code>(把store的diapatch方法挂载到props)</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> mapDispatchToProps = <span class="function">(<span class="params">dispatch</span>) =&gt;</span> &#123; <span class="comment">//state就是store里的数据</span></span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        changeInputvalue(e)&#123;</span><br><span class="line">           <span class="keyword">const</span> action=&#123;</span><br><span class="line">               type:<span class="string">'change_input_value'</span>  <span class="comment">//组件里就是onclick=&#123;this.props.changeInputvalue&#125;</span></span><br><span class="line">               value:e.target.value</span><br><span class="line">           &#125;</span><br><span class="line">           dispatch(action); <span class="comment">//这一派发就要去写reducer了（匹配类型返回一个新的newState-&gt;newState有inputvalue和list）</span></span><br><span class="line">        &#125;     </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">上述的代码还需像之前一样创建actiontypes和actionCreaters文件</span><br><span class="line">connect生成返回的结果就是一个容器组件（可以理解成业务逻辑，数据，方法对UI组件进行包装）</span><br></pre></td></tr></table></figure>
<h2 id="day5"><a href="#day5" class="headerlink" title="day5"></a>day5</h2><h2 id="开始实战"><a href="#开始实战" class="headerlink" title="开始实战"></a>开始实战</h2><p><strong>1、引入reset.css文件</strong></p>
<blockquote>
<p>使用reset.css的好处：不同浏览器的内核里面对html，body这样的标签，默认样式得设置是不同的，有可能在某一个浏览器上margin间距值是10，而在另外一个浏览器上这个间距值可能就是8。为了能让我们代码在所有浏览器表现形式都是一致的，首先就得对这些浏览器默认对这些标签的实现进行统一，reset.css就是干这个活，使得这些标签在任何浏览器上的margin padding默认都是一样的。一般在开发项目的时候，首先就要先引入reset.css文件。</p>
</blockquote>
<hr>
<p><strong>2、简书网站头部区块的编写</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">与之前不一样的是，对样式的处理需要创建一个style.js文件（样式写在这个文件里，实际上是一个个的组件，不会影响其他页面的组件样式）</span><br><span class="line">也就是我们这个页面用这个组件时候。这些样式只作用这个组件上面，对其他任何地方都没有影响，有效避免写项目潜在的可能css样式冲突的问题</span><br><span class="line"><span class="keyword">import</span> styled <span class="keyword">from</span> <span class="string">'styled-components'</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> HeaderWrapper = styled.div<span class="string">`</span></span><br><span class="line"><span class="string">    height:56px;</span></span><br><span class="line"><span class="string">    background:red;</span></span><br><span class="line"><span class="string">`</span></span><br><span class="line"> HeaderWrapper是带样式的div标签 </span><br><span class="line"> 用法在header组件里引入后使用  &lt;HeaderWrapper&gt;header&lt;<span class="regexp">/HeaderWrapper&gt; </span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">注意点:</span></span><br><span class="line"><span class="regexp">	1.在style.js写的样式都要加分号``;``不然样式显示不出来</span></span><br><span class="line"><span class="regexp">	2.a标签不能设置宽高，必须转换为块元素</span></span><br><span class="line"><span class="regexp">    3.头部导航条设置padding 不然会导致设置的图标重合</span></span><br></pre></td></tr></table></figure>
<p><img data-src="/images/loading.gif" data-original="https://gitee.com/letter-from-berlin/PictureBed/raw/master/202111201038700.png" alt="image-20211120103759703"></p>
<blockquote>
<p>就像这样 因此需要去设置头部导航条</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">  width:<span class="number">960</span>px;</span><br><span class="line">  height:<span class="number">100</span>%;</span><br><span class="line">  margin: <span class="number">0</span> auto;</span><br><span class="line"> +padding-right:<span class="number">70</span>px;</span><br><span class="line"> +box-sizing:border-box</span><br><span class="line">+号为添加的代码，设置一个内聚变以便使其隔开，但是为了保证盒子宽度不变，还得将盒子设置成border-box</span><br><span class="line"></span><br><span class="line">由于搜索框和图标是独立的，因此需要&lt;SearchWrapper&gt;&lt;<span class="regexp">/SearchWrapper&gt;标签将其包裹</span></span><br><span class="line"><span class="regexp">由于该标签被Nav标签包裹且在Nav标签里的子标签都设置了浮动，宽度失效。如果SearchWrapper不设置浮动，宽度就会继承Nav的宽度</span></span><br><span class="line"><span class="regexp">就与搜索框的宽度不一致，因此也得将SearchWrapper设置浮动。</span></span><br></pre></td></tr></table></figure>
<h2 id="day6"><a href="#day6" class="headerlink" title="day6"></a>day6</h2><p><strong>整体交换的流程</strong></p>
<blockquote>
<p>创建store文件夹-&gt;创建index.js ,reducer.js-&gt;编写相应的内容如下</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">index.js:</span><br><span class="line"><span class="keyword">import</span> &#123;createStore&#125; <span class="keyword">from</span> <span class="string">'redux'</span></span><br><span class="line"><span class="keyword">import</span> reducer <span class="keyword">from</span> <span class="string">'./reducer'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> store = createStore(reducer)</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> store;</span><br><span class="line"></span><br><span class="line">reducer.js:</span><br><span class="line"><span class="keyword">const</span> defaultState = &#123;&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> (state = defaultState,action)=&gt;&#123;</span><br><span class="line">    <span class="keyword">return</span> state;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>之后回到App.js引入</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> store <span class="keyword">from</span> <span class="string">'./store/index'</span></span><br><span class="line"><span class="keyword">import</span> &#123;Provider&#125; <span class="keyword">from</span> <span class="string">'react-redux'</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="class"><span class="keyword">class</span> <span class="title">App</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</span><br><span class="line">  render () &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">    &lt;Provider store=&#123;store&#125;&gt;</span><br><span class="line">        &lt;Header/&gt;</span><br><span class="line">    &lt;<span class="regexp">/Provider&gt;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p> 回到header组件引入connect,，将组件和store做一个连接</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;connect&#125; <span class="keyword">from</span> <span class="string">'react-redux'</span></span><br><span class="line"><span class="keyword">const</span> mapStateToProps=<span class="function"><span class="params">()</span>=&gt;</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> mapDispatchToProps=<span class="function"><span class="params">()</span>=&gt;</span>&#123;</span><br><span class="line">    <span class="keyword">return</span>&#123;</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> connect(mapStateToProps,mapDispatchToProps)(Header)</span><br></pre></td></tr></table></figure>
<blockquote>
<p>由于初始化的数据需要放在reducer.js上 所以将组件里的数据进行转移      —&gt;形成版本1</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">Header/index.js 将状态转移后删除</span><br><span class="line"><span class="keyword">constructor</span>(props)&#123;</span><br><span class="line">        <span class="keyword">super</span>(props)</span><br><span class="line">        <span class="keyword">this</span>.state=&#123;</span><br><span class="line">            focused:<span class="literal">false</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">reduer.js</span><br><span class="line"><span class="keyword">const</span> defaultState = &#123;</span><br><span class="line">    focused:<span class="literal">false</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>由于header组件里有很多是用到state里的focused,因此得将从state拿改成从props拿， 此时就需要mapState…方法</p>
<p>将store里状态的focused映射到组件的Props里去,因此就可以将下方图中的state替换成props</p>
</blockquote>
<p><img data-src="/images/loading.gif" data-original="https://gitee.com/letter-from-berlin/PictureBed/raw/master/202111220951787.png" alt="image-20211122095058838"></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">handleInputFocus=<span class="function"><span class="params">()</span>=&gt;</span>&#123;     </span><br><span class="line">     <span class="keyword">this</span>.setState(&#123;</span><br><span class="line">            focused:<span class="literal">true</span></span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">handleInputBlur=<span class="function"><span class="params">()</span>=&gt;</span>&#123;  </span><br><span class="line">     <span class="keyword">this</span>.setState(&#123;</span><br><span class="line">            focused:<span class="literal">false</span></span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">这两个方法之前是为了去改变state里的数据 现在数据都不在state里存放了因此就可以连同方法删掉</span><br></pre></td></tr></table></figure>
<blockquote>
<p>之后我们要实现当聚焦的时候要改变focused的值 -&gt;一整套流程</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">当你聚焦的时候，改变store里的数据，就要去调用store的dispatch方法，就要把方法定义在mapDispatch...里</span><br><span class="line">Focus=&#123;<span class="keyword">this</span>.handleInputFocus&#125;</span><br><span class="line">onBlur=&#123;<span class="keyword">this</span>.handleInputBlur&#125;</span><br><span class="line">改成</span><br><span class="line">onFocus=&#123;<span class="keyword">this</span>.props.handleInputFocus&#125;</span><br><span class="line">onBlur=&#123;<span class="keyword">this</span>.props.handleInputBlur&#125;</span><br><span class="line">有这个方法之后，首先要改变store里的数据首先要创建一个action</span><br><span class="line"><span class="keyword">const</span> mapDispatchToProps=<span class="function">(<span class="params">dispatch</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="keyword">return</span>&#123;</span><br><span class="line">        handleInputFocus()&#123;</span><br><span class="line">            <span class="keyword">const</span> action = &#123;</span><br><span class="line">                type:<span class="string">'search_focus'</span></span><br><span class="line">            &#125;;</span><br><span class="line">        	dispatch(action)  </span><br><span class="line">        &#125;,</span><br><span class="line">        handleInputBlur()&#123;</span><br><span class="line">            <span class="keyword">const</span> action = &#123;</span><br><span class="line">                type:<span class="string">'search_blur'</span></span><br><span class="line">            &#125;;</span><br><span class="line">            dispatch(action)</span><br><span class="line">&#125;&#125;&#125;</span><br><span class="line"></span><br><span class="line">reducers.js</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span>  (state = defaultState,action)=&gt;&#123;</span><br><span class="line">    <span class="keyword">if</span>(action.type===<span class="string">'search_focus'</span>)&#123;</span><br><span class="line">        <span class="keyword">return</span>&#123;</span><br><span class="line">            focused:<span class="literal">true</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(action.type===<span class="string">'search_blur'</span>)&#123;</span><br><span class="line">        <span class="keyword">return</span>&#123;</span><br><span class="line">            focused:<span class="literal">false</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> state;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>总结</strong></p>
<blockquote>
<p>我们把之前组件里的数据移除了，转移到redux公共存储的框架进行存储。Header组价就变成了一个无状态组件</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">无状态组件的写法 <span class="keyword">const</span> Header = <span class="function">(<span class="params">props</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="number">1.</span>render以下的内容（不包括render）</span><br><span class="line">    <span class="number">2.</span>所有的<span class="keyword">this</span>去掉</span><br><span class="line">&#125;</span><br><span class="line">到这形成第<span class="number">2</span>版</span><br></pre></td></tr></table></figure>
<h2 id="day7"><a href="#day7" class="headerlink" title="day7"></a>day7</h2><blockquote>
<p>安装redux-devtools-extension工具使得网页可以显示redux组件操作状态的变化</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> composeEnhancers = <span class="built_in">window</span>.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__ || compose;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> store = createStore(reducer,composeEnhancers())</span><br></pre></td></tr></table></figure>
<p><img data-src="/images/loading.gif" data-original="https://gitee.com/letter-from-berlin/PictureBed/raw/master/202111222124933.png" alt="image-20211122212415727"></p>
<blockquote>
<p>由于reducers存放数据和数据的处理，随着功能的强大，数据量会越来越大，因此不能都放在reducers里存储。</p>
<p>于是在head文件夹下创建一个store的文件夹，创建一个header下的reducer，将store里的reuders移至header的reducers</p>
<p>全局的reducer作为一个仓库，专门来放置各个组件部分的reducers。 此时功能尚未实现，因为header下的index.js文件mapState…方法用的是全局的reducer，因此得修改如下</p>
</blockquote>
 <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> mapStateToProps=<span class="function">(<span class="params">state</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        focused: state.header.focused</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">仓库reducers</span><br><span class="line"><span class="keyword">import</span> &#123;combineReducers&#125; <span class="keyword">from</span> <span class="string">'redux'</span></span><br><span class="line"><span class="keyword">import</span> &#123;reducer <span class="keyword">as</span> headreducer&#125; <span class="keyword">from</span> <span class="string">'../common/header/store'</span>  <span class="comment">//间接引入reducers 目录结构会少两层 </span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> reducer = combineReducers(&#123;</span><br><span class="line"></span><br><span class="line">    header:headreducer</span><br><span class="line"></span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> reducer</span><br><span class="line">间接引入reducers 目录结构会少两层 因为header下的reduces间接由header下的index.js文件管理了 。引入的时候就方便了</span><br></pre></td></tr></table></figure>
<h2 id="day8"><a href="#day8" class="headerlink" title="day8"></a>day8</h2><blockquote>
<p>由于现在在header组件下创建了一个头部的reducers，由于在头部组件里改变数据的时候派发action，然后reducer接收action然后去修改数据，之前课程说过action不要写成对象，类型也不要写成字符串。用actionCreate去创建action，同时类型定义成常量。</p>
<p>按这个做下去逻辑太绕了，不易理解。大改文件夹存放的位置 </p>
</blockquote>
<p><img data-src="/images/loading.gif" data-original="https://gitee.com/letter-from-berlin/PictureBed/raw/master/202111231119404.png" alt="image-20211123111850307"></p>
<blockquote>
<p>在reducer.js文件里,不能对原始的state做修改，为了防止这一点得引入facebook团队研发出来的一个库：immutable.js</p>
<p>它会帮助我们生成一个immutable对象 （不可改变的）如果state是immutable对象就是不可以被改变，就不会出问题。</p>
<p>immutable这个库提供了一个fromJS方法，可以帮助我们把一个js对象转化为immutable对象，用这个方法把数据对象（js对象）</p>
<p>转化为immutable对象。此时header下的index文件的mapState方法里的数据已经转化为immutable类型的数据（state.header）</p>
<p>如果是immutable类型的数据，再进行state.header.focused这种语法是不合理的了。immutable.js里面调用state.header里的属性不能通过点focused的方式来调用，得通过点get的方法传入focused的属性来获取对应的属性。此时不会报错，但是点击的时候就会报错报错的原因在与当你派发一个action的时候，传入reducers返回的是一个普通对象，普通对象时没有get方法的 为了防止这种情况应该这样写（没修改前与修改前的代码）</p>
<p>总结：借助immutable这个库避免编写改变数据里state的情况</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">未修改前的reducers:</span><br><span class="line"><span class="keyword">import</span> &#123;SEARCH_FOCUS,SEARCH_BLUR&#125; <span class="keyword">from</span> <span class="string">'../constant'</span></span><br><span class="line"><span class="keyword">const</span> defaultState = &#123;</span><br><span class="line">     focused:<span class="literal">false</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> reducer = <span class="function">(<span class="params">state = defaultState,action</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(action.type===SEARCH_FOCUS)&#123;</span><br><span class="line">        <span class="keyword">return</span>&#123;</span><br><span class="line">            focused:<span class="literal">true</span>&#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(action.type===SEARCH_BLUR)&#123;</span><br><span class="line">        <span class="keyword">return</span>&#123;</span><br><span class="line">            focused:<span class="literal">false</span>&#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> state;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> reducer</span><br><span class="line"></span><br><span class="line">修改前的header下的index.js</span><br><span class="line"><span class="keyword">const</span> mapStateToProps=<span class="function">(<span class="params">state</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        focused:state.header.focused</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">修改后的reducers:</span><br><span class="line"><span class="keyword">import</span> &#123;SEARCH_FOCUS,SEARCH_BLUR&#125; <span class="keyword">from</span> <span class="string">'../constant'</span></span><br><span class="line"><span class="keyword">import</span> &#123;fromJS&#125; <span class="keyword">from</span> <span class="string">'immuatble'</span></span><br><span class="line"><span class="keyword">const</span> defaultState = fromJS(&#123;</span><br><span class="line">     focused:<span class="literal">false</span></span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">const</span> reducer = <span class="function">(<span class="params">state = defaultState,action</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(action.type===SEARCH_FOCUS)&#123;</span><br><span class="line">       <span class="comment">// immutable对象的set方法，会结合之前immutable对象的值和设置的值,返回一个全新的对象，并没有改变原始的state</span></span><br><span class="line">        <span class="keyword">return</span> state.set(<span class="string">'focused'</span>,<span class="literal">true</span>) <span class="comment">//这里的变更不是直接变更</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(action.type===SEARCH_BLUR)&#123;</span><br><span class="line">        <span class="keyword">return</span> state.set(<span class="string">'focused'</span>,<span class="literal">false</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> state;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> reducer</span><br><span class="line"></span><br><span class="line">修改后的header下的index.js</span><br><span class="line"><span class="keyword">const</span> mapStateToProps=<span class="function">(<span class="params">state</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        focused:state.header.get(<span class="string">'focused'</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p> 即便是修改后的index.js 由于state是js对象，state.header是immutable对象 所以去调用focused属性的时候，数据获取的行为是不统一的。（不太靠谱）因此我们想让state也成为immutable对象，而不是js对象</p>
<p>state对应的数据是在redux下reducers里的index.js里创建的，因此我们要依赖第三方的模块 redu-immutable</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;combineReducers&#125; <span class="keyword">from</span> <span class="string">'redux-immutable'</span><span class="comment">//只要combineReducers是由这个库引入的reducer就是immuable对象了  </span></span><br><span class="line">之后回到header下改如下代码即可</span><br><span class="line">focused:state.get(<span class="string">'header'</span>).get(<span class="string">'focused'</span>)</span><br><span class="line">可以简写为 focused:state.getIn([<span class="string">'header'</span>,<span class="string">'focused'</span>])</span><br></pre></td></tr></table></figure>
<p><strong>下一阶段（搜索区域的布局） F11退出全屏</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">  &lt;SearchList&gt;</span><br><span class="line">    &lt;SearchInfoItem&gt;教育&lt;<span class="regexp">/SearchInfoItem&gt;</span></span><br><span class="line"><span class="regexp">    &lt;SearchInfoItem&gt;简书&lt;/</span>SearchInfoItem&gt;</span><br><span class="line">    &lt;SearchInfoItem&gt;生活&lt;<span class="regexp">/SearchInfoItem&gt;</span></span><br><span class="line"><span class="regexp">    &lt;SearchInfoItem&gt;投稿&lt;/</span>SearchInfoItem&gt;</span><br><span class="line">    &lt;SearchInfoItem&gt;历史&lt;<span class="regexp">/SearchInfoItem&gt;</span></span><br><span class="line"><span class="regexp"> &lt;/</span>SearchList&gt;</span><br><span class="line">由于子元素设置浮动了 父元素的高度无法被撑起所以给父元素设置一个BFC</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> SearchList = styled.div<span class="string">`</span></span><br><span class="line"><span class="string">    overflow:hidden;//此时只是开启BFC使其高度和宽度不丢失</span></span><br><span class="line"><span class="string">`</span>;</span><br><span class="line">之后就是该列表聚焦的时候显示，不聚焦的时候不显示，设置一个函数，给函数接收一个变量show。</span><br><span class="line">如果show为真就返回整个列表，假就返回<span class="literal">null</span></span><br><span class="line">最后再调用一下这个方法   &#123;getListArea(props.focused)&#125; 传入focused的值即可</span><br></pre></td></tr></table></figure>
<p><strong>换一批的功能</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">此时的header是一个无状态组件，之后还要添加很多功能，就会出现函数嵌套函数，就会使Header变得越来越庞大，不好维护</span><br><span class="line">因此还是使用Component组件 将原来props前加一个<span class="keyword">this</span> 且将显示列表的方法定义在组件里接口</span><br><span class="line"></span><br><span class="line">由于列表里的内容实际上是通过ajax数据获取的，因此header里不进要有focused的数据还得有列表的内容</span><br><span class="line">因此在header的reducer里加一个list:[]; </span><br><span class="line">当导航的input框做了聚焦之后，就要获取ajax数据，也就是onFocus的时候，onFocus执行的是handleInputFocus这个方法</span><br><span class="line">找到这个方法在方法里获取ajax数据，之前的课程有说过，获取ajax数据一般来说不会直接写在组件里，会把异步的操作放到action，或者放到redux-saga里面进行处理，这里统一使用redux-thunk，把异步操作都放至action里处理</span><br><span class="line">redux-thunk其实就是action和store之间的中间件 其实就是对dispatch方法的升级</span><br><span class="line">因此得写在创建store之前被使用</span><br><span class="line"><span class="keyword">import</span> &#123;createStore,compose,applyMiddleware&#125; <span class="keyword">from</span> <span class="string">'redux'</span></span><br><span class="line"><span class="keyword">import</span> thunk <span class="keyword">from</span> <span class="string">'redux-thunk'</span></span><br><span class="line"><span class="keyword">import</span> reducer <span class="keyword">from</span> <span class="string">'./reducers'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> composeEnhancers = <span class="built_in">window</span>.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__ || compose;</span><br><span class="line"><span class="keyword">const</span> store = createStore(reducer,composeEnhancers(</span><br><span class="line">    applyMiddleware(thunk)</span><br><span class="line">))</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> store;</span><br><span class="line">有了redux-thunk之后，就可以去action里面做异步操作了</span><br><span class="line">dispatch(getList());去派发这样一个action</span><br><span class="line">以前的action返回的是一个对象，现在可以返回函数</span><br><span class="line">函数里写个输出<span class="number">123</span> 只要聚焦控制台就会显示<span class="number">123</span></span><br><span class="line">发请求前要先安装包axios  </span><br><span class="line">axios.get(<span class="string">'/api/headerList.json'</span>).then(<span class="function">(<span class="params">res</span>)=&gt;</span>&#123;</span><br><span class="line">        &#125;).catch(<span class="function"><span class="params">()</span>=&gt;</span>&#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">'ERROR'</span>);         </span><br><span class="line">        &#125;)       </span><br><span class="line">&#125;</span><br><span class="line">在public文件夹下创建一个api文件夹之后在创建headerList.json的文件输入一下数据 之后在网页访问这个链接页面就可以显示数据</span><br><span class="line">原理:首先先到功能目录下看看有没有对应的路由，找不到就会去public目录下找api的headerList.json，找到后就会把文件的内容输出出来</span><br><span class="line">通过这个特性，我们可以创建一些假数据，保存。</span><br><span class="line">模拟的数据要和后端对的数据要保持一直，就是定一下格式</span><br><span class="line">public下的api下的header.json添加模拟的数据 此时:</span><br><span class="line">axios.get(<span class="string">'/api/headerList.json'</span>).then(<span class="function">(<span class="params">res</span>)=&gt;</span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(res <span class="comment">// 当你点击搜索的时候，控制台已经有输出了 见下图</span></span><br><span class="line">        &#125;).catch(<span class="function"><span class="params">()</span>=&gt;</span>&#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">'ERROR'</span>);         </span><br><span class="line">        &#125;)       </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img data-src="/images/loading.gif" data-original="https://gitee.com/letter-from-berlin/PictureBed/raw/master/202111231623925.png" alt="image-20211123162311226"></p>
<blockquote>
<p>之前header下的reducer里定义了一个list：[]，现在发送了一个ajax请求，获取到了结果，现在就是希望能用获取的结果替换那个空数组</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">action.js文件里</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> getList = <span class="function"><span class="params">()</span> =&gt;</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="function">(<span class="params">dispatch</span>)=&gt;</span>&#123;  <span class="comment">//返回函数，就要就是去派发一个异步的请求</span></span><br><span class="line">        axios.get(<span class="string">'/api/headerList.json'</span>).then(<span class="function">(<span class="params">res</span>)=&gt;</span>&#123;</span><br><span class="line">            <span class="keyword">const</span> data = res.data;</span><br><span class="line">            <span class="keyword">const</span> action = changeList(data.data);</span><br><span class="line">            dispatch(action)</span><br><span class="line">        &#125;).catch(<span class="function"><span class="params">()</span>=&gt;</span>&#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">'ERROR'</span>);</span><br><span class="line">            </span><br><span class="line">        &#125;)&#125;&#125;</span><br><span class="line"></span><br><span class="line">reducer.js文件里</span><br><span class="line"><span class="keyword">if</span>(action.type===CHANGELIST)&#123;</span><br><span class="line">    <span class="keyword">return</span> state.set(<span class="string">'list'</span>,action.data) </span><br><span class="line">    <span class="comment">//console.log(action);//返回的是&#123;type: "change_list", data: Array(50)&#125;</span></span><br><span class="line">    <span class="keyword">return</span> state</span><br><span class="line">这样写实际上还是有问题的：创建store，默认list是一个空数组，fromJS方法会将js对象转换为immuable对象，list是个数组，也会变成immuable的数组，但是调用<span class="keyword">set</span>去改变list的时候，action.data实际上是一个普通的数组， list数组会由immuable数组变成一个普通的数组，这样的话数据类型就会变了，解决这个问题</span><br><span class="line">export const changeList = (data) =&gt;(&#123;</span><br><span class="line">    type:CHANGELIST,</span><br><span class="line">    data:fromJS(data)</span><br><span class="line">&#125;)</span><br><span class="line">这样转换一下 <span class="keyword">const</span> action = changeList(data.data);<span class="comment">//输出data后的结果</span></span><br><span class="line">这里派发的时候数据就会转换成immuable的数据类型。这样reducer里接收到action的数据类型也就是immuable类型了。</span><br><span class="line">做到这里就可以使用redux的插件去查看显示header里面就list的数组了</span><br></pre></td></tr></table></figure>
<p><img data-src="/images/loading.gif" data-original="https://gitee.com/letter-from-berlin/PictureBed/raw/master/202111231710590.png" alt="image-20211123170830305"></p>
<blockquote>
<p>之后就是将list里的数组逐一放至getListArea的方法里展示</p>
</blockquote>
<p><strong>总结</strong></p>
<blockquote>
<p>实际上讲的就是项目中用react-thunk发送ajax数据。获取到数据之后，存到store里面，然后在页面上进行显示，有几个关键点</p>
<p>第一个我们把异步获取的逻辑都拆分到actions文件夹下，如果你想拆分到这里来，就要求action返回的对象不能是一个js对象，而是一个函数，如果要返回的是一个函数就必要要用redux-thunk这个中间件，这是第一个重点</p>
<p>第二个当我们获取到数据，想要改变store里的数据的时候，我们要注意redux里的list因为外层包裹了一个fromJS，它会在创建的时候，会把内部的list定义的数组由一个普通的数组转换为immuable类型的数组，但是想直接改变这个状态的数组，就会把之前immuable类型变成普通数组的类型，因为我们就要再action之前传递action之前就要把数据转换为immuable类型的数据，这样数据统一就不会有问题。</p>
<p>页面循环展示数据，就要调用map方法通过对每一项进行循环展示，对对应的内容都展示在页面上  —功能实现</p>
</blockquote>
<p><strong>避免无意义的ajax请求发送（上方衔接最后补充的内容）</strong></p>
<blockquote>
<p>每点击一次焦点的时候就会发送一次ajax请求。实际上列表中的数据获取一次就可以了</p>
<p>解决问题：给<code>handleInputFocus(list)</code>传入list 然后输出list可以看出第一次请求的时候list.size是0，之后就是50，</p>
<p>所以控制当size为0的时候才发送请求，之后不等于0的时候就不发生了，这样就避免了每次获取焦点的时候都发一个ajax请求，从而做到性能上的调优。</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"> handleInputFocus(list)&#123;</span><br><span class="line">            <span class="keyword">if</span>(list.size===<span class="number">0</span>)&#123;</span><br><span class="line">                  dispatch(getList());</span><br><span class="line">            &#125; 					 或者 (list.size&gt;<span class="number">0</span>)&amp;&amp;dispatch(getList());意思都一样</span><br><span class="line">            dispatch(searchFocus());</span><br><span class="line">        &#125;,</span><br><span class="line">            </span><br><span class="line">样式加一个cursor:pointer 可使鼠标放上去有个小手的标志。</span><br></pre></td></tr></table></figure>
<p> <strong>路由</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;BrowserRouter,Route&#125; <span class="keyword">from</span> <span class="string">'react-router-dom'</span></span><br><span class="line">BrowserRouter代表路由 Route代表路由规则</span><br><span class="line">首先先引入路由组件</span><br><span class="line">下载包:npm add react-router-dom</span><br><span class="line">**注意** 前两周这个包刚更新过如果按之前的编码规则会使得路由组件无法显示(太坑了官网也不发布，害我整了半天)</span><br></pre></td></tr></table></figure>
<p><img data-src="/images/loading.gif" data-original="https://gitee.com/letter-from-berlin/PictureBed/raw/master/202111242012568.png" alt="image-20211124201227148"></p>
<blockquote>
<p>把首页组件拆分成一个个小的组件</p>
<p>  外层元素：margin-left: -18px;</p>
<p>  内层元素：margin-left: 18px;、</p>
<p>  这样就可以充分利用左侧栏的宽度，使其保持一直</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">   &lt;TopicItem&gt;</span><br><span class="line">               &lt;img</span><br><span class="line">        className=<span class="string">'topic-pic'</span></span><br><span class="line">        src=<span class="string">'//upload.jianshu.io/collections/images/261938/man-hands-reading-boy-large.jpg?							imageMogr2/auto-orient/strip'</span> alt=<span class="string">'niao'</span></span><br><span class="line">        /&gt;</span><br><span class="line">            社会热点</span><br><span class="line">&lt;<span class="regexp">/TopicItem&gt;</span></span><br><span class="line"><span class="regexp">这是一个标题数据，之后我们拿来用的时候需要从redux里取 数据都存在store里，而Topic是home的自组件 而home是APP的子组件</span></span><br><span class="line"><span class="regexp">因此Topic是APP的自组件 想使用store里的数据需要connect做连接</span></span><br><span class="line"><span class="regexp">定义一个获取状态的方法 mapState,从reducer获取到list给Topic组件遍历即可</span></span><br></pre></td></tr></table></figure>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React, &#123; Component &#125; <span class="keyword">from</span> <span class="string">'react'</span></span><br><span class="line"><span class="keyword">import</span> &#123;TopicWrapper,TopicItem&#125; <span class="keyword">from</span> <span class="string">'../style'</span></span><br><span class="line"><span class="keyword">import</span> &#123;connect&#125; <span class="keyword">from</span> <span class="string">'react-redux'</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Topic</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</span><br><span class="line">    render() &#123;</span><br><span class="line">        <span class="keyword">return</span> (</span><br><span class="line">            &lt;TopicWrapper&gt;</span><br><span class="line">                &#123;<span class="keyword">this</span>.props.list.map(<span class="function">(<span class="params">item</span>)=&gt;</span>&#123;</span><br><span class="line">                    <span class="keyword">return</span> (</span><br><span class="line">                        &lt;TopicItem key=&#123;item.get(<span class="string">'id'</span>)&#125;&gt;</span><br><span class="line">                        &lt;img</span><br><span class="line">                            className=<span class="string">'topic-pic'</span></span><br><span class="line">                            src=&#123;item.get(<span class="string">'imgUrl'</span>) &#125; <span class="comment">//reducer.js定义好的</span></span><br><span class="line">                            alt=<span class="string">"nihao"</span>/&gt;</span><br><span class="line">                        &#123;item.get(<span class="string">'title'</span>)&#125;</span><br><span class="line">                    &lt;<span class="regexp">/TopicItem&gt;</span></span><br><span class="line"><span class="regexp">                    )</span></span><br><span class="line"><span class="regexp">                &#125;)&#125;</span></span><br><span class="line"><span class="regexp">      </span></span><br><span class="line"><span class="regexp">            &lt;/</span>TopicWrapper&gt;</span><br><span class="line">        )</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> mapState  =<span class="function">(<span class="params">state</span>) =&gt;</span>(&#123;</span><br><span class="line">    list: state.get(<span class="string">'home'</span>).get(<span class="string">'topicList'</span>)</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> connect(mapState,<span class="literal">null</span>)(Topic)<span class="comment">//因为不需要修改状态 所以暂且先传入一个null</span></span><br></pre></td></tr></table></figure>
<h2 id="day9"><a href="#day9" class="headerlink" title="day9"></a>day9</h2><blockquote>
<p>页面的组件，首先闲在reducer的初始状态定义好相应的信息</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">articleList:[&#123;</span><br><span class="line">       id: <span class="number">1</span>,</span><br><span class="line">       title:<span class="string">'大数据分析可视化平台'</span>,</span><br><span class="line">       desc:<span class="string">'支持直连MySQL、SQL Server、PostgreSQL、Oracle、SAP HANA、Hive等数据源，也可上传本地Excel/Csv文件或通过API连接数据。可完成多源交互分析'</span>,</span><br><span class="line">       imgUrl:<span class="string">'https://lupic.cdn.bcebos.com/20200412/3048304592_14_800_600.jpg'</span></span><br><span class="line">   &#125;,&#123;</span><br><span class="line">       id: <span class="number">2</span>,</span><br><span class="line">       title:<span class="string">'大数据分析可视化平台'</span>,</span><br><span class="line">       desc:<span class="string">'支持直连MySQL、SQL Server、PostgreSQL、Oracle、SAP HANA、Hive等数据源，也可上传本地Excel/Csv文件或通过API连接数据。可完成多源交互分析'</span>,</span><br><span class="line">       imgUrl:<span class="string">'https://lupic.cdn.bcebos.com/20200412/3048304592_14_800_600.jpg'</span></span><br><span class="line">   &#125;],</span><br></pre></td></tr></table></figure>
<blockquote>
<p>之后在组件里通过调用connect 里调用因为这个状态是immuable数据类型 因此需要用get方法来引入</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React, &#123; Component &#125; <span class="keyword">from</span> <span class="string">'react'</span></span><br><span class="line"><span class="keyword">import</span> &#123;RecommendWrapper,RecommendItem&#125; <span class="keyword">from</span> <span class="string">'../style'</span></span><br><span class="line"><span class="keyword">import</span> &#123;connect&#125; <span class="keyword">from</span> <span class="string">'react-redux'</span></span><br><span class="line"><span class="comment">// import imgone from '../1.jpg'</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Recommend</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</span><br><span class="line">    render() &#123;</span><br><span class="line">        <span class="keyword">return</span> (</span><br><span class="line">            &lt;RecommendWrapper&gt;</span><br><span class="line">                &#123;</span><br><span class="line">                   <span class="keyword">this</span>.props.list.map(<span class="function">(<span class="params">item</span>)=&gt;</span>&#123;</span><br><span class="line">                       <span class="keyword">return</span>   <span class="xml"><span class="tag">&lt;<span class="name">RecommendItem</span> <span class="attr">imgUrl</span>=<span class="string">&#123;item.get(</span>'<span class="attr">imgUrl</span>')&#125; <span class="attr">key</span>=<span class="string">&#123;item.get(</span>'<span class="attr">id</span>')&#125;/&gt;</span></span></span><br><span class="line">                   &#125;)</span><br><span class="line">                &#125;</span><br><span class="line">            &lt;<span class="regexp">/RecommendWrapper&gt;</span></span><br><span class="line"><span class="regexp">        )</span></span><br><span class="line"><span class="regexp">    &#125;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp">const mapState=(state)=&gt;(&#123;</span></span><br><span class="line"><span class="regexp">    list: state.getIn(['home','recommendList'])</span></span><br><span class="line"><span class="regexp">&#125;)</span></span><br><span class="line"><span class="regexp">export default connect(mapState)(Recommend)</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>首先所有的数据内容都存在前端的代码里，都是写死的，实际做项目的时候，通过接口来获取的，不能写死。</p>
<p>在public下的api定义一个接口home.json。之后在home组件下借助componentDidMount这个声明周期函数来发ajax请求去获取数据，获取了数据，（当组件挂载完毕）。就要将获取的数据取修改store里初试的数据</p>
<p>所以要创建一个action，派发给store，需要store和组件建立连接</p>
<p>修改store里的数据也就是状态 就得使用connect的第二个参数，通过这个函数就可以定义一个方法将action派发给store</p>
<p>因为UI组件不能和store直接通信，只能通过容器组件。派发给store之后store就会派发给reducer。</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">case</span> <span class="string">'change_home_data'</span>:</span><br><span class="line">        <span class="built_in">console</span>.log(action);<span class="comment">//返回的就是ajax请求获取出来的内容</span></span><br><span class="line">        state.set(<span class="string">'topicList'</span>,action.topicList)</span><br><span class="line"><span class="comment">//action.topicList是JS对象而上面的topicList是immuable对象不能替换因此要在前面加一个fromJS（action.topicList）</span></span><br><span class="line">由于是多个对象可以用state的一个方法做一个合并 这样就实现了通过ajax异步的形式获取到了首页的内容</span><br></pre></td></tr></table></figure>
<blockquote>
<p>上述的操作都是不合适的因为UI组件不应该有太多的业务逻辑，发ajax请求不应该在UI组件里发，放在容器组件里</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">修改前</span><br><span class="line">componentDidMount()&#123;</span><br><span class="line">        axios.get(<span class="string">'./api/home.json'</span>).then(<span class="function">(<span class="params">res</span>)=&gt;</span>&#123;</span><br><span class="line">            <span class="keyword">const</span> result = res.data.data;</span><br><span class="line">            <span class="built_in">console</span>.log(res);<span class="comment">//如果成功会打印 因为这个路径下有这个文件 因此是可以成功的</span></span><br><span class="line">            <span class="keyword">const</span> action=&#123;</span><br><span class="line">                type:<span class="string">'change_home_data'</span>,</span><br><span class="line">                topicList:result.topicList,</span><br><span class="line">                articleList:result.articleList,</span><br><span class="line">                recommendList:result.recommendList</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// console.log(res.data.data);</span></span><br><span class="line">            <span class="keyword">this</span>.props.changeHomeData(action)</span><br><span class="line">            </span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> mapDispatch = <span class="function">(<span class="params">dispatch</span>)=&gt;</span>(&#123;</span><br><span class="line">    changeHomeData(action)&#123;</span><br><span class="line">        dispatch(action);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> connect(<span class="literal">null</span>,mapDispatch)(Home)  </span><br><span class="line">第一次修改后：</span><br><span class="line">    componentDidMount()&#123;</span><br><span class="line">       </span><br><span class="line">            <span class="comment">// console.log(res.data.data);</span></span><br><span class="line">            <span class="keyword">this</span>.props.changeHomeData()</span><br><span class="line">            </span><br><span class="line">     </span><br><span class="line">&#125;&#125;</span><br><span class="line"><span class="keyword">const</span> mapDispatch = <span class="function">(<span class="params">dispatch</span>)=&gt;</span>(&#123;</span><br><span class="line">    changeHomeData()&#123;</span><br><span class="line">        axios.get(<span class="string">'./api/home.json'</span>).then(<span class="function">(<span class="params">res</span>)=&gt;</span>&#123;</span><br><span class="line">            <span class="keyword">const</span> result = res.data.data;</span><br><span class="line">            <span class="keyword">const</span> action=&#123;</span><br><span class="line">                type:<span class="string">'change_home_data'</span>,</span><br><span class="line">                topicList:result.topicList,</span><br><span class="line">                articleList:result.articleList,</span><br><span class="line">                recommendList:result.recommendList</span><br><span class="line">            &#125;</span><br><span class="line">        dispatch(action);</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> connect(<span class="literal">null</span>,mapDispatch)(Home)</span><br></pre></td></tr></table></figure>
<blockquote>
<p>再次升级 ajax请求不放在容器组件里 放在action里 通过调用那个函数</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">componentDidMount()&#123;      </span><br><span class="line">            <span class="comment">// console.log(res.data.data);</span></span><br><span class="line">            <span class="keyword">this</span>.props.changeHomeData()          </span><br><span class="line">&#125;&#125;</span><br><span class="line"><span class="keyword">const</span> mapDispatch = <span class="function">(<span class="params">dispatch</span>)=&gt;</span>(&#123;</span><br><span class="line">    changeHomeData()&#123;</span><br><span class="line">        dispatch(getHomeInfo())<span class="comment">//因为派发的action是一个函数 且返回的是一个函数。如果这个action是个函数，就会顺序执行这个函数，执行这个函数action就会去派发 页面就重新执行了</span></span><br><span class="line">    &#125;&#125;);</span><br></pre></td></tr></table></figure>
<blockquote>
<p>而后action里代码可以做升级</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">action下home.js</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">'axios'</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> getHomeInfo = <span class="function"><span class="params">()</span> =&gt;</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="function">(<span class="params">dispatch</span>)=&gt;</span>&#123;  <span class="comment">//返回函数，就要就是去派发一个异步的请求</span></span><br><span class="line">        axios.get(<span class="string">'./api/home.json'</span>).then(<span class="function">(<span class="params">res</span>)=&gt;</span>&#123;</span><br><span class="line">            <span class="keyword">const</span> result = res.data.data;</span><br><span class="line">            <span class="keyword">const</span> action=&#123;</span><br><span class="line">                type:<span class="string">'change_home_data'</span>,</span><br><span class="line">                topicList:result.topicList,</span><br><span class="line">                articleList:result.articleList,</span><br><span class="line">                recommendList:result.recommendList</span><br><span class="line">            &#125;</span><br><span class="line">            dispatch(action);</span><br><span class="line">        &#125;)</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">优化后</span><br><span class="line"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">'axios'</span></span><br><span class="line"><span class="keyword">const</span> changeHomeData=<span class="function">(<span class="params">result</span>)=&gt;</span>(&#123;</span><br><span class="line">    type:<span class="string">'change_home_data'</span>,</span><br><span class="line">    topicList:result.topicList,</span><br><span class="line">    articleList:result.articleList,</span><br><span class="line">    recommendList:result.recommendList</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> getHomeInfo = <span class="function"><span class="params">()</span> =&gt;</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="function">(<span class="params">dispatch</span>)=&gt;</span>&#123;  <span class="comment">//返回函数，就要就是去派发一个异步的请求</span></span><br><span class="line">        axios.get(<span class="string">'./api/home.json'</span>).then(<span class="function">(<span class="params">res</span>)=&gt;</span>&#123;</span><br><span class="line">            <span class="keyword">const</span> result = res.data.data;</span><br><span class="line">            <span class="keyword">const</span> action = changeHomeData(result)</span><br><span class="line">            dispatch(action);  或者写成    dispatch(changeHomeData(result))</span><br><span class="line">        &#125;)</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">之后让type成常量 </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;LoadMore onClick=&#123;<span class="keyword">this</span>.props.getMore&#125;&gt;更多文字&lt;<span class="regexp">/LoadMore&gt;*** 不用写()</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>对于页数的编码，首先先在reducers定义一个初始状态，定义完之后就可以回到List组件里定义mapState方法中的page：state…</p>
<p>定义完之后将UI组件里的LoadMore里的onClick的回调函数设置为箭头函数 传page进去， 下面调用方法的函数也传page</p>
<p>之后发异步action</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"> &lt;LoadMore onClick=&#123;()=&gt;<span class="keyword">this</span>.props.getMore(<span class="keyword">this</span>.props.page)&#125;&gt;更多文字&lt;<span class="regexp">/LoadMore&gt;</span></span><br><span class="line"><span class="regexp">&lt;/</span>div&gt;</span><br><span class="line">          </span><br><span class="line">        )</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> mapState =<span class="function">(<span class="params">state</span>)=&gt;</span>(&#123;</span><br><span class="line">    list:state.get(<span class="string">'home'</span>).get(<span class="string">'articleList'</span>),</span><br><span class="line">    page:state.get(<span class="string">'home'</span>).get(<span class="string">'articlePage'</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> mapDispatch=<span class="function">(<span class="params">dispatch</span>)=&gt;</span>(&#123;</span><br><span class="line">    getMore(page)&#123;</span><br><span class="line">        dispatch(getMoreList(page))</span><br><span class="line">    &#125;&#125;)</span><br><span class="line"></span><br><span class="line">异步action</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> getMoreList=<span class="function">(<span class="params">page</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="function">(<span class="params">dispatch</span>)=&gt;</span>&#123;</span><br><span class="line">      </span><br><span class="line">        axios.get(<span class="string">'./api/homeList.json?page='</span> + page).then(<span class="function">(<span class="params">res</span>)=&gt;</span>&#123;</span><br><span class="line">            <span class="keyword">const</span> result = res.data.data;</span><br><span class="line">            <span class="keyword">const</span> action = AddHomeData(result,page+<span class="number">1</span>)   <span class="comment">//这里每次点击更多的时候页面加1</span></span><br><span class="line">            dispatch(action);</span><br><span class="line">        &#125;);</span><br><span class="line">        </span><br><span class="line">    &#125;&#125;</span><br><span class="line">每一个异步action都有一个同步action</span><br><span class="line"><span class="keyword">const</span> AddHomeData = <span class="function">(<span class="params">list,nextpage</span>)=&gt;</span>(&#123;</span><br><span class="line">    type:ADD_HOME_LIST,</span><br><span class="line">    list:fromJS(list),   </span><br><span class="line">    nextpage</span><br><span class="line"></span><br><span class="line">&#125;)</span><br><span class="line">之后就回到reducer 去更新原始页面的状态</span><br></pre></td></tr></table></figure>
<p><strong>回到顶部</strong></p>
<blockquote>
<BackTop onClick={this.handleScrollTop}>回到顶部</BackTop>

</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">handleScrollTop() &#123;</span><br><span class="line">		<span class="built_in">window</span>.scrollTo(<span class="number">0</span>, <span class="number">0</span>);<span class="comment">//回到顶部 </span></span><br><span class="line">	&#125;  </span><br><span class="line"></span><br><span class="line">之后实现页面再顶部的时候不显示回到顶部这个图标  在底部才实现</span><br></pre></td></tr></table></figure>
<blockquote>
<p>然后在home.js下的传入connect的第一个参数</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> mapState =<span class="function">(<span class="params">state</span>)=&gt;</span>(&#123;</span><br><span class="line">    showScroll:state.getIn([<span class="string">'home'</span>,<span class="string">'showScroll'</span>])  <span class="comment">//由于reducer的初始值有定义</span></span><br><span class="line">&#125;)</span><br><span class="line">控制这个值的<span class="literal">true</span>和<span class="literal">false</span> 来实现是否显示回到顶部的功能</span><br><span class="line">&#123;<span class="keyword">this</span>.props.showScroll ? <span class="xml"><span class="tag">&lt;<span class="name">BackTop</span> <span class="attr">onClick</span>=<span class="string">&#123;this.handleScrollTop&#125;</span>&gt;</span>回到顶部<span class="tag">&lt;/<span class="name">BackTop</span>&gt;</span></span>:<span class="literal">null</span>&#125;</span><br></pre></td></tr></table></figure>
<h2 id="day10"><a href="#day10" class="headerlink" title="day10"></a>day10</h2><blockquote>
<p>在组件刚挂载的时候绑定一个监听事件来监测滚轮是是否滑动</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">componentDidMount()&#123;</span><br><span class="line">            <span class="keyword">this</span>.props.changeHomeData()</span><br><span class="line">            <span class="keyword">this</span>.bindEvents();</span><br><span class="line">&#125;</span><br><span class="line">    bindEvents()&#123;</span><br><span class="line">        <span class="built_in">window</span>.addEventListener(<span class="string">'scroll'</span>,<span class="keyword">this</span>.props.changeScrollTopShow)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">调用的方法:</span><br><span class="line">   changeScrollTopShow(e)&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(e);  <span class="comment">//打印的就是下图一个个事件</span></span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p><img data-src="/images/loading.gif" data-original="https://gitee.com/letter-from-berlin/PictureBed/raw/master/202111260957851.png" alt="image-20211126095729529"></p>
<blockquote>
<p>如果不打印事件 换做</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">document</span>.documentElement.scrollTop(获取滚动条位置)要获取当前页面的滚动条纵坐标位置</span><br><span class="line"> changeScrollTopShow()&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="built_in">document</span>.documentElement.scrollTop);</span><br><span class="line">    &#125;</span><br><span class="line">我也不明白为什么我打印出的是小数</span><br></pre></td></tr></table></figure>
<p><img data-src="/images/loading.gif" data-original="https://gitee.com/letter-from-berlin/PictureBed/raw/master/202111261002063.png" alt="image-20211126100207963"></p>
<blockquote>
<p>之后将这个值设置大于400的时候显示回到顶部，否则隐藏，因此我们要改reducer里的数据，通过发action进行改</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">changeScrollTopShow()&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">document</span>.documentElement.scrollTop&gt;<span class="number">400</span>)&#123;</span><br><span class="line">            dispatch(toggleTopShow(<span class="literal">true</span>))</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            dispatch(toggleTopShow(<span class="literal">false</span>))</span><br><span class="line">        &#125;</span><br><span class="line">    </span><br><span class="line">action.js文件       </span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> toggleTopShow=<span class="function">(<span class="params">show</span>)=&gt;</span>(&#123;</span><br><span class="line">    type:TOGGLE_SCROLL_TOP,</span><br><span class="line">    show</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">reducer.js文件</span><br><span class="line"> <span class="keyword">case</span>  TOGGLE_SCROLL_TOP:</span><br><span class="line">       <span class="keyword">return</span> state.set(<span class="string">'showScroll'</span>,action.show)</span><br><span class="line">功能实现 但是需要注意的是创建组件组件挂载的时候，往<span class="built_in">window</span>上绑定的scroll事件的监听的时候，一定要把scroll事件监听在<span class="built_in">window</span>上移除</span><br><span class="line">这样组件的事件就不会影响其他的组件</span><br><span class="line">reducer.js代码优化:</span><br><span class="line"></span><br><span class="line">    <span class="keyword">case</span> CHANGE_HOME_DATA:</span><br><span class="line">    <span class="keyword">return</span> state.merge(&#123;</span><br><span class="line">        topicList:fromJS(action.topicList),</span><br><span class="line">        articleList:fromJS(action.articleList),</span><br><span class="line">        recommendList:fromJS(action.recommendList)</span><br><span class="line">    &#125;)</span><br><span class="line">    </span><br><span class="line">    定义一个方法</span><br><span class="line">    <span class="keyword">const</span> changeHomeData=<span class="function">(<span class="params">state,action</span>)=&gt;</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> state.merge(&#123;</span><br><span class="line">            topicList:fromJS(action.topicList),</span><br><span class="line">            articleList:fromJS(action.articleList),</span><br><span class="line">            recommendList:fromJS(action.recommendList)</span><br><span class="line">        &#125;)</span><br><span class="line">&#125;</span><br><span class="line">    然后调用： </span><br><span class="line">    <span class="keyword">case</span> CHANGE_HOME_DATA:</span><br><span class="line">            <span class="keyword">return</span> changeHomeData(state,action)  ***修改部分</span><br><span class="line">        <span class="keyword">case</span> ADD_HOME_LIST:</span><br><span class="line">            <span class="keyword">return</span> addhomedata(state,action)</span><br></pre></td></tr></table></figure>
<p><strong>首页性能调优</strong></p>
<blockquote>
<p>因为首页的index.js都调用了connect的方法，和store做了连接，这就会产生一个问题，只要store发生了改变，那么每一个组件都会被重新渲染，也就是每个函数的render函数会被重新执行，可能有些数据发生改变了，但是那个数据和这个组件一点关系都没有，但是这个组件依然会被重新渲染，导致性能不好。提高组价性能 shouldComponentUpdata，可以在这里做性能优化的代码，判断只有与这个组件相关的数据发生改变才让render函数重新执行（重新渲染），否则return false不让render函数重新执行。</p>
<p>通过这种方式来避免虚拟DOM的比对，提高性能，react也考虑到了这点，如果你在每个特组件都去自己写should….太麻烦了，react内置了新的组件类型，引入PureComponent，区别就是PureComponent内在自己底层实现了should…,这样就不用我们手写收should……做性能优化。之后就是每个UI组件都替换为PureComponent</p>
<p>之所以项目用<strong>PureComponent</strong>，是因为项目的数据管理用了immuable.js的框架，它可以保证我们的数据是immuable的，这样PureComponent和immuablejs数据格式的管理相结合，使用PureComponent一点问题都没有，但是如果你在你的项目里面，没有使用immuable.js管理你的数据，那么使用PureComponen有的时候会遇到坑。（偏底层的坑）</p>
</blockquote>
<p><strong>实现点击title跳转至详情页面</strong></p>
<blockquote>
<p>当我们在react实现页面跳转的时候，我们要用到react-router-dom第三方模块，它的这种跳转是单页应用跳转，所谓单页应用跳转就是做一个单页应用的时候，单页应用指的是，不管怎么做页面的跳转，整个网站只会加载一个html文件，只会加载一次html文件，那么来看使用a标签来做页面的跳转，符不符合单页应用的定义。network里Doc可以看加载的html文件，使用a标签就是会重新加载html文件，会由原来的localhost变为detail的html，增加了一次html请求，比较耗性能，因为借助react-router-dom的时候，完全没必要重新加载页面，做页面的跳转，正确的做法是用Link代替a标签。</p>
<p>注意：link标签要在Router里面否则会报错，在做头部点击简书logo的时候，因为link在head里，而APP组件的Header是在BrowseRouter外部因此违背了这个规则 导致报错</p>
</blockquote>
<p><img data-src="/images/loading.gif" data-original="https://gitee.com/letter-from-berlin/PictureBed/raw/master/202111261120619.png" alt="image-20211126111958584"></p>
<p>或者是报这个错</p>
<p><img data-src="/images/loading.gif" data-original="https://gitee.com/letter-from-berlin/PictureBed/raw/master/202111261121636.png" alt="img"></p>
<h2 id="day11"><a href="#day11" class="headerlink" title="day11"></a>day11</h2><p><strong>详情页面的布局</strong></p>
<blockquote>
<p>从reducer里导入初试状态的content时候会导致标签转义，所以页面显示的内容不是该有的内容。</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">dangerouslySetInnerHTML=&#123;&#123;<span class="attr">__html</span>: <span class="keyword">this</span>.props.content&#125; 这样写不会被转义</span><br><span class="line"></span><br><span class="line">之后这些数据想在后端被获取而不是通过store里的原始数据取获取。就需要发ajax请求，步骤都是和之前一样</span><br></pre></td></tr></table></figure>
<p><strong>实现点击不同的title显示不同的详情页（匹配id）</strong></p>
<blockquote>
<p>在List.js文件夹下 <Link key={index} to={'./detail/' + item.get('id')}>路径下加上一个id  打开浏览器不显示了</p>
<p>原因是在APP.js组件里路由组件匹配的路径是/detail 而不是/detail/1 因此得在路由组件匹配的时候出换一个‘/detail/：id’</p>
<p>获取参数的第一种方法：动态获取参数</p>
<p>首先打开详情页面的代码 在render和return之间先 打印输出log（this.props）//在控制台里可以看出props里match里的params里有id 然后就是在组件挂载时传入id</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">action.js</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> getDetail=<span class="function">(<span class="params">id</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="function">(<span class="params">dispatch</span>)=&gt;</span>&#123;</span><br><span class="line">        axios.get(<span class="string">'/api/detail.json?id='</span>+ id).then(<span class="function">(<span class="params">res</span>)=&gt;</span>&#123;<span class="comment">//把id传给后端</span></span><br><span class="line">            <span class="keyword">const</span> result=res.data.data;</span><br><span class="line">            <span class="comment">// console.log(res.data.data);</span></span><br><span class="line">            dispatch(changeDetail(result.title,result.content))</span><br><span class="line">            </span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">detail下的index.js</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Detail</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</span><br><span class="line">    render() &#123;</span><br><span class="line">        <span class="keyword">return</span> (</span><br><span class="line">            &lt;DetailWrapper&gt;</span><br><span class="line">                &lt;Header&gt;&#123;<span class="keyword">this</span>.props.title&#125;&lt;<span class="regexp">/Header&gt;</span></span><br><span class="line"><span class="regexp">                &lt;Content dangerouslySetInnerHTML=&#123;&#123;__html: this.props.content&#125;&#125;/</span>&gt;</span><br><span class="line">            &lt;<span class="regexp">/DetailWrapper&gt;</span></span><br><span class="line"><span class="regexp">        )</span></span><br><span class="line"><span class="regexp">    &#125;</span></span><br><span class="line"><span class="regexp">    componentDidMount()&#123;</span></span><br><span class="line"><span class="regexp">        const &#123;id&#125; = this.props.param</span></span><br><span class="line"><span class="regexp">        this.props.getDetail(id);/</span><span class="regexp">/通过后端去返回</span></span><br><span class="line"><span class="regexp">    &#125;  </span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp">const mapState=(state)=&gt;(&#123;</span></span><br><span class="line"><span class="regexp">    title: state.get('detail').get('title'),</span></span><br><span class="line"><span class="regexp">    content: state.get('detail').get('content')</span></span><br><span class="line"><span class="regexp">&#125;)</span></span><br><span class="line"><span class="regexp">const mapDispatch=(dispatch)=&gt;(&#123;</span></span><br><span class="line"><span class="regexp">    getDetail(id)&#123;</span></span><br><span class="line"><span class="regexp">        dispatch(getDetail(id));</span></span><br><span class="line"><span class="regexp">    &#125;</span></span><br><span class="line"><span class="regexp">&#125;)</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">然后传递路由参数出现了问题 是由于使用了react-router-dom v6的版本 下面有解释</span></span><br><span class="line"><span class="regexp">export default connect(mapState, mapDispatch)((props)=&gt;(</span></span><br><span class="line"><span class="regexp">    &lt;Detail</span></span><br><span class="line"><span class="regexp">    &#123;...props&#125;</span></span><br><span class="line"><span class="regexp">    param=&#123;useParams()&#125;</span></span><br><span class="line"><span class="regexp">    /</span>&gt;</span><br><span class="line">))</span><br></pre></td></tr></table></figure>
<p><strong>巨坑由于使用了react-router-dom v6的版本 使得组件props参数里没有location history等属性。如果使用v5的话就完全避免了这个问题（使用v5下载包的时候附上版本号yarn add react-router-dom@5.3.0）</strong></p>
<p><img data-src="/images/loading.gif" data-original="https://gitee.com/letter-from-berlin/PictureBed/raw/master/202111261925280.png" alt="image-20211126192533225"></p>
<p><img data-src="/images/loading.gif" data-original="https://gitee.com/letter-from-berlin/PictureBed/raw/master/202111261926068.png" alt="image-20211126192612881"></p>
<p><strong>登陆组件</strong></p>
<blockquote>
<p>创建reducers 定义初始状态，login：false 之后在去头部的map方法里那login组件里的login</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">login:state.getIn([<span class="string">'login'</span>,<span class="string">'login'</span>])</span><br><span class="line">&#123;</span><br><span class="line">login ? <span class="xml"><span class="tag">&lt;<span class="name">NavItem</span> <span class="attr">className</span>=<span class="string">'right'</span>&gt;</span>退出<span class="tag">&lt;/<span class="name">NavItem</span>&gt;</span></span>:<span class="xml"><span class="tag">&lt;<span class="name">NavItem</span> <span class="attr">className</span>=<span class="string">'right'</span>&gt;</span>登陆<span class="tag">&lt;/<span class="name">NavItem</span>&gt;</span></span></span><br><span class="line">&#125;</span><br><span class="line">就可以在页面的头部看到是否处于登陆状态还是退出状态</span><br></pre></td></tr></table></figure>
<blockquote>
<p>接下来如果用户没有登陆不是显示这个字样 而是跳转到登陆页面</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"> &lt;Link to=<span class="string">'/login'</span>&gt;<span class="xml"><span class="tag">&lt;<span class="name">NavItem</span> <span class="attr">className</span>=<span class="string">'right'</span>&gt;</span>登陆<span class="tag">&lt;/<span class="name">NavItem</span>&gt;</span></span>&lt;<span class="regexp">/Link&gt;</span></span><br><span class="line"><span class="regexp">回到登陆组件</span></span><br><span class="line"><span class="regexp"> &lt;Button onClick=&#123;() =&gt; this.props.login(this.account, this.password)&#125;&gt;登录&lt;/</span>Button&gt;</span><br><span class="line">因为登陆需要调用ajax接口，把账号密码传递过去的。这时候需要把它写进mapDispatch里 因为要发异步的请求，异步action</span><br><span class="line">只有它才能派发异步action</span><br><span class="line"></span><br><span class="line">&lt;Input placeholder=<span class="string">"账号"</span> ref=&#123;(input) =&gt; &#123;<span class="keyword">this</span>.account = input&#125;&#125; /&gt;</span><br><span class="line">&lt;Input placeholder=<span class="string">"密码"</span> type=<span class="string">"password"</span> ref=&#123;(input) =&gt; &#123;<span class="keyword">this</span>.password = input&#125;&#125; /&gt;</span><br><span class="line">这两句话的意思就是:通过ref把这两个DOM分别存在<span class="keyword">this</span>.account和<span class="keyword">this</span>.password里</span><br><span class="line">这样在登陆的时候就可以调用箭头函数把account和password传进去</span><br><span class="line">之后就是发ajax请求 action reducers 常见的套路 </span><br><span class="line">实现的结果就是输入账号密码之后头部的登陆变成了退出  现在就是要实现点击登陆跳转到首页</span><br><span class="line">重定向到首页 又是版本的问题，之前的重定向Redirect也不能用了</span><br></pre></td></tr></table></figure>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123;loginState&#125; = <span class="keyword">this</span>.props;<span class="comment">//false</span></span><br><span class="line">    <span class="keyword">if</span>(!loginState)&#123;</span><br><span class="line">        <span class="keyword">return</span> (</span><br><span class="line">            &lt;LoginWrapper&gt;</span><br><span class="line">            &lt;LoginBox&gt;</span><br><span class="line">            &lt;Input placeholder=<span class="string">"账号"</span> ref=&#123;(input) =&gt; &#123;<span class="keyword">this</span>.account = input&#125;&#125; /&gt;</span><br><span class="line">    &lt;Input placeholder=<span class="string">"密码"</span> type=<span class="string">"password"</span> ref=&#123;(input) =&gt; &#123;<span class="keyword">this</span>.password = input&#125;&#125; /&gt;</span><br><span class="line">    &lt;Button onClick=&#123;() =&gt; <span class="keyword">this</span>.props.login(<span class="keyword">this</span>.account, <span class="keyword">this</span>.password)&#125;&gt;登录&lt;<span class="regexp">/Button&gt;</span></span><br><span class="line"><span class="regexp">    &lt;/</span>LoginBox&gt;</span><br><span class="line">    &lt;<span class="regexp">/LoginWrapper&gt;</span></span><br><span class="line"><span class="regexp">    )</span></span><br><span class="line"><span class="regexp">    &#125;else&#123;</span></span><br><span class="line"><span class="regexp">        return &lt; Navigate  to='/</span><span class="string">' /&gt;</span></span><br><span class="line"><span class="string">    &#125;   </span></span><br><span class="line"><span class="string">之后做退出的功能回到header组件的index.js下</span></span><br></pre></td></tr></table></figure>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"> &#123;</span><br><span class="line">     login ?</span><br><span class="line">         &lt;NavItem className=<span class="string">'right'</span>&gt;退出&lt;<span class="regexp">/NavItem&gt;:</span></span><br><span class="line"><span class="regexp">         &lt;Link to='/</span>login<span class="string">'&gt;&lt;NavItem className='</span>right<span class="string">'&gt;登陆&lt;/NavItem&gt;&lt;/Link&gt;</span></span><br><span class="line"><span class="string"> &#125;</span></span><br><span class="line"><span class="string"> 在这里添加一个点击事件onClick=&#123;logout&#125;通过调用该回调函数去修改login的值，所以要去派发action</span></span><br><span class="line"><span class="string"> 因为这是在header.js下的 要引用login的action</span></span><br><span class="line"><span class="string">修改数据得到的结果也就是头部的显示结果 就是点击退出的时候上面的退出会改成登陆</span></span><br></pre></td></tr></table></figure>
<p><strong>创建写文章（只有在登陆状态下才能写）</strong></p>
<blockquote>
<p>对于一个组件的实现流程：首先建立writer文件夹下的index.js 把login复制过来，沿用它的一些逻辑</p>
<p>如果登陆了就写文章，如果没有登陆就跳转到登陆见面 然后把这个组件放到APP.js里面 。</p>
<p>同时在头部组件里的一个写文章外部加一个Link 跳转到Writer组件里之后就不做了 </p>
</blockquote>
<p><strong>代码优化</strong></p>
<ol>
<li>在每个方法后面加分号；</li>
<li>在action里发异步请求的时候都默认发成功的请求，在企业级项目都有错误的情况.catch（）异常逻辑进行补充</li>
</ol>
<p><strong>异步组件</strong></p>
<blockquote>
<p>首先点开network组件 JS刷新页面， 跳转页面，登陆页面，都是加载bundle.js，存在一个问题：所有页面对应的组件代码，都是bundle.js，现在访问的是首页，实际上登陆和详情页面的代码一起都加载了，这样首页加载的速度就有点慢。解决问题：当你访问首页的时候，你只加载首页的代码，访问详情页的时候再去加载详情页的代码 使用异步组件来实现，底层比较复杂，但是使用封装起来的第三方模块会非常简单。</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">npm add react-loadable</span><br><span class="line">异步组件的时候会有一个问题如果是v5版本的话</span><br><span class="line">detail下的index.js是有用到params参数的，以前可以直接获取是因为 </span><br><span class="line">因为APP.js里以前引入的Detail组件，路由对应的组件就是这个组件<span class="keyword">import</span> Detail <span class="keyword">from</span> <span class="string">'./pages/detail'</span>;</span><br><span class="line">&lt;Route path=<span class="string">'/detail/:id'</span> exact component=&#123;Detail&#125;&gt;&lt;<span class="regexp">/Route&gt;</span></span><br><span class="line"><span class="regexp">如果是这样detail可以直接拿到路由信息</span></span><br><span class="line"><span class="regexp">但是现在不一样了引入的是import Detail from './</span>pages/detail/loadable.js<span class="string">';</span></span><br><span class="line"><span class="string">所以loadable.js可以获得所有的路由信息，但是它下面的组件获取不了路由内容，因为它不是Router直接对应的组件</span></span><br><span class="line"><span class="string">箭头所示的就是下面的组件 </span></span><br><span class="line"><span class="string">解决方法就是在index.js组件里加一个withRouter **这是v5的  v6不需要以上操作</span></span><br><span class="line"><span class="string">调用该方法让Detail组件有能力获取到Router里所以的参数和内容</span></span><br><span class="line"><span class="string">export default connect(mapState, mapDispatch)(withRouter(Detail));</span></span><br></pre></td></tr></table></figure>
<p><img data-src="/images/loading.gif" data-original="https://gitee.com/letter-from-berlin/PictureBed/raw/master/202111262208581.png" alt="image-20211126220845485"></p>
<p><strong>注意</strong>：使用jsx语法要引入React</p>
<h2 id="day12"><a href="#day12" class="headerlink" title="day12"></a>day12</h2><p><strong>补充（之前漏看的视频）</strong></p>
<blockquote>
<p>首先在header组件的初始状态定义一个page和totalpage。page的作用是通过页码对内容进行控制，totalpage指的是整体的数据一共有多少页。 通过点击输入框就可以将获取列表，在列表里的action获取到数据后在同步action里面定义总共的页码。</p>
<p>之后在把页面传给reducers，打开reudx点击搜索就可以看到如下获取的列表和总共的页码</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">之后在map方法里获取页码  <span class="string">``</span>  page:state.getIn([<span class="string">'header'</span>,<span class="string">'page'</span>]),<span class="string">``</span></span><br></pre></td></tr></table></figure>
<p><img data-src="/images/loading.gif" data-original="https://gitee.com/letter-from-berlin/PictureBed/raw/master/202111271938134.png" alt="image-20211127192232109"></p>
<blockquote>
<p> 之后在map方法里获取页码  <code>page:state.getIn([&#39;header&#39;,&#39;page&#39;]),</code></p>
<p>让它一页显示10个</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">const</span> &#123;focused,list,page&#125;=<span class="keyword">this</span>.props</span><br><span class="line"><span class="keyword">const</span> pageList=[];</span><br><span class="line"><span class="keyword">const</span> Listpage = list.toJS(); <span class="comment">//因为从props里获取的list是immuable数据类型 该数据类型不能使用Listpage[i]方法，要先转换</span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">let</span> i=(page<span class="number">-1</span>)*<span class="number">10</span>;i&lt;page*<span class="number">10</span>;i++)&#123;</span><br><span class="line">            pageList.push(</span><br><span class="line">                &lt;SearchInfoItem key=&#123;Listpage[i]&#125;&gt;&#123;Listpage[i]&#125;&lt;<span class="regexp">/SearchInfoItem&gt;</span></span><br><span class="line"><span class="regexp">            )</span></span><br><span class="line"><span class="regexp">        &#125;</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>之后点击搜索显示的就是10个内容 但是才存在一个问题，点击换一换的时候input框会失焦，一失焦下面的区块就隐藏掉了，什么时候隐藏，其实并不是靠这个input的focus来控制的。实际点击区块的白色部分的时候，已经失焦但是区块不会隐藏，把鼠标移出去的时候才会隐藏。因此下面区块的展示和隐藏并不是完全由focus的状态来决定的还由一个mouseleft和mousemove决定的。</p>
<p>因此再加一个属性   mouseIn:false,，因为一开始鼠标就是没进入这个区块，鼠标移入进去，变成true。</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">&lt;SearchInfo onMouseEnter=&#123;<span class="keyword">this</span>.props.handleMouseEnter&#125;<span class="comment">//定义一个方法 派发action</span></span><br><span class="line">改变mouseIn:<span class="literal">false</span>,这个的状态</span><br><span class="line">同理再加一个 onMouseLeave=&#123;<span class="keyword">this</span>.props.handleMouseLeave&#125;这个方法</span><br><span class="line">一直我们是通过focus来控制显示还是隐藏，其实现在focus不管用，还得借助mouseIn这个变量一起来控制，因此要从mapstate拿到mouseIn</span><br><span class="line"><span class="keyword">if</span>(focused||mouseIn)如果mouseIn为<span class="literal">true</span>也显示</span><br><span class="line">下面就是点击换一换 下面的内容也要跟着变</span><br><span class="line">定义方法onClick=&#123;<span class="keyword">this</span>.props.handleChangePage&#125;</span><br><span class="line">handleChangePage()&#123;</span><br><span class="line">            dispatch(changePage())<span class="comment">//派发action</span></span><br><span class="line">        &#125;,</span><br><span class="line">之后就是修改page的状态由于状态修改page不能直接加<span class="number">1</span></span><br><span class="line">因此还要获取totalPage的状态</span><br><span class="line"> handleChangePage(page,totalPage)&#123;</span><br><span class="line">  <span class="keyword">if</span>(page&lt;totalPage)&#123;</span><br><span class="line">      dispatch(changePage(page+<span class="number">1</span>))</span><br><span class="line">  &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">      dispatch(changePage(<span class="number">1</span>))</span><br><span class="line">  &#125;</span><br><span class="line">把这个函数设为箭头函数之后把page和totalpage传进去之后进行判断 之后去修改状态即可</span><br><span class="line">但是还是会报错原因就是输出<span class="keyword">for</span>循环的时候输出的是<span class="literal">undefined</span>。原因是因为当你刚进入页面的时候，header就会被渲染，初始顺序就是list是个空，page是个<span class="number">1</span>， 然后<span class="keyword">for</span>循环一定会执行，所以会循环<span class="number">1</span>到<span class="number">9</span> 但是list是一个空数组，那么空数组list[<span class="number">0</span>]都是<span class="literal">undefined</span></span><br><span class="line">那么key就是<span class="literal">undefined</span>。 因此外层要包裹一个<span class="keyword">if</span>判断</span><br><span class="line"> <span class="keyword">if</span>(pageList.length)&#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">let</span> i=(page<span class="number">-1</span>)*<span class="number">10</span>;i&lt;page*<span class="number">10</span>;i++)&#123;</span><br><span class="line">                pageList.push(</span><br><span class="line">                    &lt;SearchInfoItem key=&#123;Listpage[i]&#125;&gt;&#123;Listpage[i]&#125;&lt;<span class="regexp">/SearchInfoItem&gt;</span></span><br><span class="line"><span class="regexp">                )</span></span><br><span class="line"><span class="regexp">            &#125; </span></span><br><span class="line"><span class="regexp">        &#125;</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>之后点换一换的时候让i标签的动画动一下</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;SearchInfoSwitch</span><br><span class="line">    onClick=&#123;()=&gt;handleChangePage(page,totalPage,<span class="keyword">this</span>.spinIcon)&#125;</span><br><span class="line">  &gt;</span><br><span class="line">				<span class="comment">//将this.spinIcon传进onClick方法</span></span><br><span class="line">    &lt;i ref=&#123;(icon)=&gt;&#123;this.spinIcon = icon&#125;&#125; className="iconfont spin"&gt;&amp;#xe675;&lt;/i&gt;</span><br><span class="line">            换一批</span><br><span class="line"> &lt;<span class="regexp">/SearchInfoSwitch&gt;</span></span><br></pre></td></tr></table></figure>
<p>之前换一批图标功能未实现，且iconfont图标在下侧，原因是因为之前设置的iconfont样式覆盖了它</p>
<p>只要把之前的iconfont样式改成zoom即可</p>
<p>当你点击换一批的时候，我们希望i标签的值发生变化， 有一个ref的内容可以回去i标签真实的DOM节点</p>
<p> 之后把相应的值传进，之后在方法下方输出spin 控制台就会输出</p>
<p><img data-src="/images/loading.gif" data-original="https://gitee.com/letter-from-berlin/PictureBed/raw/master/202111280949745.png" alt="image-20211128094949731"></p>
<p>就获取到spin对应的DOM了</p>
<pre><code>  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">spin.style.transform=<span class="string">'rotate(360deg)'</span>;<span class="comment">//当你点击的时候就会旋转360 但是只会执行一次因为是转360</span></span><br><span class="line">可以获取上一次旋转的角度之后每一次加<span class="number">360</span>度 下一次就是<span class="number">720</span>度</span><br><span class="line"> 使用单纯CSS transition动画效果来实现</span><br><span class="line"> <span class="keyword">let</span> originAngle = spin.style.transform.replace(<span class="regexp">/[^0-9]/ig</span>,<span class="string">''</span>)<span class="comment">//不是0-9的数字都替换为空</span></span><br><span class="line">     <span class="keyword">if</span>(originAngle)&#123;</span><br><span class="line">         originAngle=<span class="built_in">parseInt</span>(originAngle,<span class="number">10</span>)</span><br><span class="line">     &#125; <span class="keyword">else</span>&#123;</span><br><span class="line">         originAngle=<span class="number">0</span>;</span><br><span class="line">     &#125;</span><br><span class="line">    spin.style.transform=<span class="string">'rotate('</span>+(originAngle+ <span class="number">360</span>)+<span class="string">'deg)'</span><span class="comment">//0-360  360-720都会有过渡效果</span></span><br><span class="line">react是面向数据编程，最难的是在redux里如何对数据进设计</span><br></pre></td></tr></table></figure>
</code></pre><hr>
<p><strong>1、react是面向数据编程，最难的是在redux里的数如何的被设计</strong></p>
<hr>
<p><strong>2、改变它里面的数据，遵循redux里单向数据流的流程，首先先派发action给store，store再给reducers，reducers返回一个新的数组再给store，store去变更自己的内容，当数据发生变更，页面就自动发生变化了。</strong></p>
<h2 id="day13"><a href="#day13" class="headerlink" title="day13"></a>day13</h2><p><strong>简书项目上线</strong></p>
<p>首先在后端的htdocs文件夹下创建一个api文件夹，后端的人在api文件夹下的json所各种复杂的运算处理，然后前端就可以将简书项目public文件夹下的api文件夹删除了，因为开发要做接口的模拟，然后在控制台运行npm run build，就会生成一个build文件夹，在build目录下有很多项目需要上线的文件，把build下的所有文件复制粘贴至htdocs文件夹下（和api一个同级）这样就完成了项目的上线。</p>
<p>整体的流程就是将前端的代码拷贝到后端的项目，访问的也就是后端的项目（访问路径就是之前的一个软件XAMPP）。</p>
<p><img data-src="/images/loading.gif" data-original="https://gitee.com/letter-from-berlin/PictureBed/raw/master/202111281533623.png" alt="image-20211128153306716"></p>
<p><img data-src="/images/loading.gif" data-original="https://gitee.com/letter-from-berlin/PictureBed/raw/master/202111281530997.png" alt="image-20211128153010553"></p>
<p>点start就可以在本地启动一个服务器（启动一个Apache服务器），会启动在localhost：80端口上（可以简写localhost）</p>
<h2 id="完美撒花"><a href="#完美撒花" class="headerlink" title="完美撒花"></a>完美撒花</h2><ol>
<li>react的基础语法</li>
<li>redux数据层框架</li>
<li>react-redux如何方便我们在react之中使用redux</li>
<li>react-router（本课程用的是4.0的版本 而我采用的是6.0天呐）</li>
<li>immuable.js 相关的第三方模块</li>
</ol>

    </div>

    
    
    
        <div class="reward-container">
  <div>万一真有土豪呢！！！</div>
  <button onclick="var qr = document.getElementById('qr'); qr.style.display = (qr.style.display === 'none') ? 'block' : 'none';">
    打赏
  </button>
  <div id="qr" style="display: none;">
      
      <div style="display: inline-block;">
        <img src="/images/loading.gif" data-original="/images/wechatpay.jpg" alt="Jony J 微信支付">
        <p>微信支付</p>
      </div>
      
      <div style="display: inline-block;">
        <img src="/images/loading.gif" data-original="/images/alipay.png" alt="Jony J 支付宝">
        <p>支付宝</p>
      </div>

  </div>
</div>


      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/%E7%AE%80%E4%B9%A6%E5%AE%9E%E6%88%98/" rel="tag"># 简书实战</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2021/11/28/JS%E9%AB%98%E7%BA%A7/" rel="prev" title="Javscript强化">
      <i class="fa fa-chevron-left"></i> Javscript强化
    </a></div>
      <div class="post-nav-item">
    <a href="/2021/12/05/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/" rel="next" title="数据结构与算法">
      数据结构与算法 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          
    <div class="comments" id="valine-comments"></div>

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#react简书实战"><span class="nav-text">react简书实战</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#day1"><span class="nav-text">day1</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#day2"><span class="nav-text">day2</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#day3"><span class="nav-text">day3</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#day4"><span class="nav-text">day4</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#day5"><span class="nav-text">day5</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#开始实战"><span class="nav-text">开始实战</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#day6"><span class="nav-text">day6</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#day7"><span class="nav-text">day7</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#day8"><span class="nav-text">day8</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#day9"><span class="nav-text">day9</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#day10"><span class="nav-text">day10</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#day11"><span class="nav-text">day11</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#day12"><span class="nav-text">day12</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#day13"><span class="nav-text">day13</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#完美撒花"><span class="nav-text">完美撒花</span></a></li></ol></li></ol></div>
      </div>
      <br/>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Jony J"
      src="/images/avatar.jpg">
  <p class="site-author-name" itemprop="name">Jony J</p>
  <div class="site-description" itemprop="description">stay hungry stay foolish！</div>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/wzt2023" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;wzt2023" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i></a>
      </span>
      <span class="links-of-author-item">
        <a href="/images/wechat.jpg" title="WeChat → &#x2F;images&#x2F;wechat.jpg"><i class="fab fa-weixin fa-fw"></i></a>
      </span>
      <span class="links-of-author-item">
        <a href="/images/qq.png" title="QQ → &#x2F;images&#x2F;qq.png"><i class="fab fa-qq fa-fw"></i></a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:710471807@qq.com" title="E-Mail → mailto:710471807@qq.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i></a>
      </span>
  </div>


  <div class="links-of-blogroll motion-element">
    <div class="links-of-blogroll-title"><i class="fa fa-link fa-fw"></i>
      友链
    </div>
    <ul class="links-of-blogroll-list">
        <li class="links-of-blogroll-item">
          <a href="https://leetcode-cn.com/problemset/all/" title="https:&#x2F;&#x2F;leetcode-cn.com&#x2F;problemset&#x2F;all&#x2F;" rel="noopener" target="_blank">leetcode</a>
        </li>
    </ul>
  </div>

      </div>
      <div id="music163player">
        <iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width=330 height=86 src="//music.163.com/outchain/player?type=2&id=441491828&auto=0&height=66"></iframe>
     
      </div>
    </div> 
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">TT 版权所有</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-area"></i>
    </span>
      <span class="post-meta-item-text">站点总字数：</span>
    <span title="站点总字数">146k</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
      <span class="post-meta-item-text">站点阅读时长 &asymp;</span>
    <span title="站点阅读时长">2:12</span>
</div>


 <div class="powered-by">
  <i class="fa fa-user-md"></i>
  <span id="busuanzi_container_site_uv">
    本站总访客数:<span id="busuanzi_value_site_uv"></span>&nbsp;&nbsp;| 
  </span>
  <span id="busuanzi_container_site_pv">
      &nbsp;本站总访问量<span id="busuanzi_value_site_pv"></span>次
  </span>
</div>
</div>

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  <script src="//cdn.jsdelivr.net/npm/animejs@3.1.0/lib/anime.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script>
  <script src="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/lozad@1/dist/lozad.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/velocity-animate@1/velocity.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/velocity-animate@1/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>


  <script defer src="//cdn.jsdelivr.net/gh/theme-next/theme-next-three@1/three.min.js"></script>
    <script defer src="//cdn.jsdelivr.net/gh/theme-next/theme-next-three@1/canvas_lines.min.js"></script>


  




  
<script src="/js/local-search.js"></script>













  

  

  


<script>
NexT.utils.loadComments(document.querySelector('#valine-comments'), () => {
  NexT.utils.getScript('//cdn.jsdelivr.net/npm/valine@1/dist/Valine.min.js', () => {
    var GUEST = ['nick', 'mail', 'link'];
    var guest = 'nick';
    guest = guest.split(',').filter(item => {
      return GUEST.includes(item);
    });
    new Valine({
      el         : '#valine-comments',
      verify     : false,
      notify     : false,
      appId      : '8YHV7splQK9asMA21ILvvuFe-gzGzoHsz',
      appKey     : 'DwFfLh2EMujmRQp3tkcWjOJI',
      placeholder: "分享你的想法",
      avatar     : 'mm',
      meta       : guest,
      pageSize   : '10' || 10,
      visitor    : false,
      lang       : '' || 'zh-cn',
      path       : location.pathname,
      recordIP   : false,
      serverURLs : ''
    });
  }, window.Valine);
});
</script>


  <script async src="/js/cursor/fireworks.js"></script>




  <script src="/js/activate-power-mode.min.js"></script>
  <script>
    POWERMODE.colorful = true;
    POWERMODE.shake = false;
    document.body.addEventListener('input', POWERMODE);
  </script>

  
<script>
            window.imageLazyLoadSetting = {
                isSPA: false,
                processImages: null,
            };
        </script><script>window.addEventListener("load",function(){var t=/\.(gif|jpg|jpeg|tiff|png)$/i,r=/^data:image\/[a-z]+;base64,/;Array.prototype.slice.call(document.querySelectorAll("img[data-original]")).forEach(function(a){var e=a.parentNode;"A"===e.tagName&&(e.href.match(t)||e.href.match(r))&&(e.href=a.dataset.original)})});</script><script>!function(n){n.imageLazyLoadSetting.processImages=i;var e=n.imageLazyLoadSetting.isSPA,r=Array.prototype.slice.call(document.querySelectorAll("img[data-original]"));function i(){e&&(r=Array.prototype.slice.call(document.querySelectorAll("img[data-original]")));for(var t,a=0;a<r.length;a++)0<=(t=(t=r[a]).getBoundingClientRect()).bottom&&0<=t.left&&t.top<=(n.innerHeight||document.documentElement.clientHeight)&&function(){var t,e,n,i,o=r[a];t=o,e=function(){r=r.filter(function(t){return o!==t})},n=new Image,i=t.getAttribute("data-original"),n.onload=function(){t.src=i,e&&e()},n.src=i}()}i(),n.addEventListener("scroll",function(){var t,e;t=i,e=n,clearTimeout(t.tId),t.tId=setTimeout(function(){t.call(e)},500)})}(this);</script></body>
</html>
